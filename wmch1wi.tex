%\documentclass[12pt,a4paper,BCOR15mm,twoside,DIV12]{article}
\documentclass{article}
%\usepackage[paper=a4paper,left=20mm,right=20mm,top=25mm,bottom=25mm]{geometry}
\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{color}
\usepackage{enumerate}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{hyperref}
\usepackage{makeidx}
\usepackage{graphicx, float,epsfig}
\usepackage[nottoc,numbib]{tocbibind}


\newcommand{\properideal}{%
  \mathrel{\ooalign{$\lneq$\cr\raise.22ex\hbox{$\lhd$}\cr}}}

\def\P{\mathcal{P}}
\def\I{\mathbb{I}}
\def\R{\mathbb{R}} 
\def\E{\mathcal{E}} 
\def\NE{\mathbb{N}_{\geq1}} 
\def\N{\mathbb{N}} 
\def\Z{\mathbb{Z}} 
\def\Q{\mathbb{Q}} 
\def\F{\mathbb{F}}
\def\Vm{\mathcal{V}_m}
\def\V{\mathcal{V}}
\def\VV{\mathbb{V}}
\def\C{\mathbb{C}}
\def\U{\mathcal{U}}
\def\a{\mathfrak{a}}
\def\b{\mathfrak{b}}
\def\p{\mathfrak{p}}
\def\q{\mathfrak{q}}
\def\s{\sigma}
\def\si{\unlhd_{\sigma}}
\def\GL{\text{GL}}
\def\supp{\text{Supp}}
\def\id{\text{id}}
\def\n{\underline{n}}
\def\Spec{\text{Spec}}
\def\sSpec{\sigma\text{-Spec}}
\def\diag{\text{diag}}
\def\End{\text{End}}
\def\Hom{\text{Hom}}
\def\fa{\text{ for all }}
\def\Tr{\text{Tr}}
\def\Id{\text{Id}}
\def\Sym{\text{Sym}}
\def\H{\mathcal{H}}
\def\wt{\text{wt}}
\def\Perf{\text{Perf}}


\renewcommand{\labelenumi}{\alph{enumi})}
%\renewcommand{\P}{\textfrak{P}}
\newcommand{\cupdot}{\mathop{\mathaccent\cdot\cup}}
\newcommand{\textsim}{\mathord{\sim}}
\newcommand{\catname}[1]{{\normalfont\textbf{#1}}}
\newcommand{\Set}{\catname{Set}}
\newcommand{\sintk}{\s\text{\catname{-int}}_k}
\newcommand{\sringk}{\s\text{\catname{-ring}}_k}
\newenvironment{bew}{\begin{proof}[Proof]}{\end{proof}}
\theoremstyle{plain}
\newtheorem{Satz}{Satz}[section]
\newtheorem{theorem}[Satz]{Theorem}
\newtheorem{ex}[Satz]{Example}
\newtheorem{cor}[Satz]{Corollary}
\newtheorem{algorithm}[Satz]{Algorithm}
\newtheorem{prop}[Satz]{Proposition}
\newtheorem{lem}[Satz]{Lemma}
\newtheorem{defn}[Satz]{Definition}
\theoremstyle{definition}
\newtheorem{rem}[Satz]{Remark}


\makeindex
\title{Mixed Ideals in Difference Algebra}
\author{Andr\'{e}s Goens}
\date{\today}
\begin{document}
\setlength{\parindent}{1.5em}
\section*{Conventions on notation for this thesis} 
We will use the following conventions throughout the thesis:
\begin{itemize}
\item $\N := \{0,1,\cdots \}$
\item $\NE := \{1,2,\cdots \}$
\item $ \n := \{1,2,\ldots, n\}$
\item $ \n_0 := n \cup \{0\}$
\item $A \setminus B = \{ a \in A \mid a \notin B \}$
\item Let $R$ be a ring, $a_1,\ldots,a_n \in R$. Then $(a_1,\ldots,a_n)$ denotes the smallest ideal of $R$ containing $a_1,\ldots,a_n$.
\item Let $R$ be a difference ring, $a_1,\ldots,a_n \in R$. Then $[a_1,\ldots,a_n]$ denotes the smallest difference ideal of $R$ containing $a_1,\ldots,a_n$.
\item Let $R$ be a difference ring. Then $A \si R$ means that A is a difference ideal of $R$.
\item The variable $y$ in (difference) polynomial rings will, in general, mean $n$ variables $y_1, \ldots, y_n$, i.e., we will write for example $k[y]$ for $k[y_1,\ldots,y_n]$.
\end{itemize}
\clearpage
\section{Basics of Difference Algebra}
\section{Difference Ideals}
When studying difference ideals, there are numerous properties in which we are interested. We will start by defining some of them:
\begin{defn}
Let  $\a \si R$ be a $\s$-ideal of $R$. 
\begin{itemize}
\item Then $\a$ is called a \emph{mixed $\s$-ideal} if for any $f,g \in R$ with $fg \in \a$ it follows that $f \sigma(g) \in \a$. \index{mixed $\s$-ideal}
\item $\a$ is called \emph{perfect}, if $\sigma^{i_1}(f) \cdots \sigma^{i_n}(f) \in \a$ implies that $f \in \a$, where $n \in \NE, i_j \in \N \fa j \in \n$. \index{perfect $\s$-ideal}
\item $\a$ is called \emph{reflexive}, if $\s(f) \in \a$ implies $f \in \a$. \index{reflexive $\s$-ideal}
\item $\a$ is called \emph{$\s$-prime}, if $\a$ is a prime, reflexive $\s$-ideal. \index{$\s$-prime}
\item The ring $R$ is called \emph{well-mixed}, if the zero ideal $[0]$ is mixed, and \emph{perfectly $\s$-reduced}, if it is perfect. \index{well-mixed $\s$-ring}\index{perfectly $\s$-reduced $\s$-ring}
\end{itemize}
\end{defn}

\begin{rem}
It is easy to see from the definitions that $\s$-prime ideals are perfect, and that perfect $\s$-ideals are mixed, radical and reflexive. Prime $\s$-ideals are also mixed, but not necessarily perfect. Note that there is a difference between a prime $\s$-ideal, and a $\s$-prime ideal:
the former does not necessarily have to be reflexive, as is the case with the latter. Both, prime $\s$-ideals and $\s$-prime ideals will be very important throughout this thesis. It is for that reason that the distinction between both is of utmost importance.
\end{rem}

All the above properties behave well with respect to morphisms of $\s$-rings in the following sense:
\begin{lem}\label{bijmapping}
Let $\varphi: R \rightarrow S$ be a morphism of $\s$-rings and $\a \si S$ a $\s$-ideal of $S$. Then $\varphi^{-1}(\a) \si R$ is a $\s$-ideal of $R$. Similarly, if $\a$ is a mixed $\s$-ideal, then so is $\varphi^{-1}(\a)$. The same is true for perfect and for reflexive $\s$-ideals.
\begin{bew}
Since $\a \unlhd S$ is an ideal, so is $\b := \varphi^{-1}(\a) \unlhd R$. Let $b \in \b$. Then $\varphi(b) =: a \in \a$ by definition. Since $\a \si S$ is a $\s$-ideal, $\s(a) \in \a$, and since $\varphi$ is a $\s$-morphism
it follows that $\sigma(a) = \sigma(\varphi(b)) = \varphi (\s (b)) \in \a$. Hence, $\s(b) \in \b$ which in turn implies that $\b$ is a $\s$-ideal. \\
\indent Now let $\a$ be mixed and $fg \in \b$. This means by definition of $\b$, 
that $\varphi(fg) = \varphi(f) \varphi(g) \in \a$. Since $\a$ is mixed, this in turn implies that $$\varphi(f) \s( \varphi(g)) = \varphi(f) \varphi(\s(g)) = \varphi(f\s(g)) \in \a,$$ which yields $f\s(g) \in \b$, so that $\b$ is also mixed. 
The proof for perfect and for reflexive difference ideals is analogous.
\end{bew}
\end{lem}

\begin{rem}
Let $R$ be a $\s$-ring and $\a \si R$ a $\s$-ideal. We can define a canonical $\s$-ring structure on the quotient ring $R/\a$ via $\s(r+\a):= \s(r) + \a$. 
This is well defined and in particular makes the canonical ring epimorphism $\tau: R \rightarrow R/\a$ a morphism of $\s$-rings.
\end{rem}

\begin{prop}\label{bijideals}
Let $R$ be a $\s$-ring and $\a \si R$ a $\s$-ideal. The canonical embedding $\iota: \a \hookrightarrow R$ induces, in the sense of Lemma \ref{bijmapping}, a bijection between the sets $\{ \b \si R/\a \}$ and $\{ \a \si \b \si R \}$. The same holds true if we restrict both sets to prime, radical and mixed, $\s$-prime or perfect $\s$-ideals.
%% \begin{bew}
%% fixme: proof!
%% \end{bew}
\end{prop}

\begin{rem}\label{wmwelldef}
Let $R$ be a $\s$-ring, and $F \subseteq R$ a subset of $R$. Any intersection of mixed, radical $\s$-ideals containing $F$ is also a mixed, radical $\s$-ideal, which of course contains $F$. 
This means that there is a smallest (with respect to inclusion) mixed, radical $\s$-ideal $\a$ containing $F$; namely, the intersection of all such $\s$-ideals:
\begin{align*} \a = \bigcap_{\substack{ \b \si R, \\ \b \text{ radical and mixed}}} \b. \end{align*}
\begin{proof}
Let $I$ be an index set and $\a_i \si R \fa i \in I$ be mixed, radical $\s$-ideals. Further let $\b := \bigcap_{i \in I} \a_i$ be the intersection of these. Obviously, $\b$ is (algebraically) an ideal of $R$. We will show that it is also a $\s$-ideal, radical and mixed.
If $a \in \a_i \fa i \in I$, then $\s(a) \in \a_i \fa i \in I$, since each $\a_i$ is a $\s$-ideal.
It follows that $\s(a) \in \b$. \\
\indent Similarly, if $aa' \in \a_i \fa i \in I$, then $a \s(a') \in \a_i \fa i \in I$, since each $\a_i$ is mixed, which implies that $a \s(a') \in \b$.  \\
\indent Finally, if $a \in \sqrt(\b)$ there exists an $n \in \N$ such that $a^n \in \b$. This means that $a^n \in \a_i \fa i \in I$, which implies that $a \in \sqrt(\a_i) \fa i \in I$. Since every $\a_i, i \in I$ is radical, this means that $a \in \a_i \fa i \in I$,
and thus $a \in \b$.
\end{proof}
\end{rem}

\begin{defn}
The $\s$-ideal $\a$ from Remark \ref{wmwelldef} is called the radical, mixed closure of $F$, and we will denote it by $\{F\}_{m}$.
\end{defn}

\begin{ex}\label{nombasisex}
Let $k$ be a constant $\s$-field and let $R:= k\{y_1,y_2\}$. Consider the difference ideal $\a:= [y_1y_2] \si R$. Then, the inductively defined chain $$\a^{\{0\}}:= \a,~ \a^{\{m+1\}}:= [\{ f \s(g) \mid f,g \in \a^{\{m\}}], \fa m \in \NE$$
is an infinite properly ascending chain of difference ideals.
\begin{bew}
We will show that $\a^{\{m\}} = [y_1\s^k(y_2) \mid k = 0,1,\ldots,m]$ by induction. The assertion that the $\a^{\{m\}}$ form an infinite chain of properly ascending $\s$-ideals is obvious from this.\\
\indent The inclusion $ [y_1\s^k(y_2) \mid k = 0,1,\ldots,m] \subseteq \a^{\{m\}}$ follows from an induction on $m$ directly from the definition of $\a^{\{m\}}$. \\ 
\indent  To show the other inclusion, ``$\supseteq$'', we do it also inductively. For $m=0$ it holds that $\a^{\{0\}} = \a = [y_1y_2]$. Let thus $m \in \N$ and $a \in \a^{\{m+1\}}$.
By definition, there exist $k \in \NE, f_i, g_i, r_i \in R$ with $f_ig_i \in \a^{\{m\}}, i = 1,\ldots,k$ such that $a = \sum_{i=1}^k r_i f_i \s(g_i)$. 

FIXME: FINISH THIS!!!!!!!

 To prove that the chain is properly ascending, it is enough to show that $y_1\s^m(y_2) \in \a^{\{m\}}$, but $y_1\s^{m+1}(y_2) \notin \a^{\{m\}}$, since $\a^{\{m\}} \subseteq \a^{\{m+1\}}$ is obvious by definition.
This can be shown by induction: For $m = 0$, it is clear that $y_1y_2 \in [y_1y_2]$, but $y_1 \s(y_2) \notin [y_1y_2]$. Now, if $y_1 \s^m(y_2) \in \a^{\{m\}}$, then by definition, $y_1 \s^{m+1}(y_2) \in \a^{\{m+1\}}$.
On the other hand, if $\y_1 \s^{m+1}(y_2) \notin \a^{\{m\}}$, then it is clear that $\y_1 \s^{m+2}(y_2) \notin \{ f\s(g) \mid f,g \in \a^{\{m\}}\} =: M$. We only need to show that $y_1\s^{m+2}(y_2) \notin [M]$.

\end{bew}
\end{ex}


\begin{rem}\label{remshuffling}
Let $R$ be a $\s$-ring, $\a \si R$ a $\s$-ideal of $R$. To try to find $\{\a\}_m$ it might be tempting to define $\a':= \{ f\s(g) \mid fg \in \a \}$. A quick example shows that this is not enough, since $\a'$ is not an ideal in general: 
For example, take $R=k\{y_1,y_2,y_3\}$ for a constant $\s$-field $k$, and $\a = [y_1y_2, y_2y_3] \si R$. Then there exist no $f,g \in R$ such that $ f \s(g) = \s(y_2)y_3 + \s(y_1)y_2 \in \{\a\}_m$ and $fg \in \a$. 
If we take the $\s$-ideal generated by $\a'$, $[\a']$, we now have no guarantee that it will remain mixed. Indeed, in the former example, $y_1\s^2(y_2) \notin [\a']$, even though $y_1 \s(y_2) \in \a'$. We could repeat the process once more,
 but this would leave $y_1 \s^3(y_2)$ out, and so forth. The union of all sets gained this way, however, does in fact work, as we shall see below.
\end{rem}

\begin{lem}\label{sqrtmixed}
Let $R$ be a $\s$-ring and $\a \si R$ be a mixed $\s$-ideal. Then the radical of $\a$, $\sqrt{\a}$, is also mixed.
\begin{bew}
Let $f,g \in R$ be such that $fg \in \sqrt \a$. By definition there exists an $n \in \NE$ such that $f^n g^n = (fg)^n \in \a$. Since $\a$ is mixed, this implies that $f^n \s(g^n) = f^n \s(g)^n = (f\s(g))^n \in \a$. 
But this implies that $f\s(g) \in \sqrt \a$, which is what we wanted to show.n
\end{bew}
\end{lem}

\begin{lem}\label{lemshuffling}
Let $R$ be a $\s$-ring and $F \subseteq R$. Further let $F' := \{f\s(g) \mid fg \in F \}$ as in Remark \ref{remshuffling}, and set $F^{\{1\}}:= [F]'$, $F^{\{m\}}:= [F^{\{m-1\}}]' \fa m \in \NE$. Then
\begin{align} \{F\}_m = \sqrt{\bigcup_{n=1}^{\infty} F^{\{n\}}}. \end{align}
This way of obtaining $\{F\}_m$ is called a shuffling processes and has an analog for perfect $\s$-ideals (see for example \cite{levin}, p. 121f.) \index{Shuffling process}
\begin{proof}
Let $\a:= \bigcup_{n=1}^{\infty} F^{\{n\}}$. It is obvious from the construction that $F \subseteq \a$. It also holds that $\a$ is a mixed $\s$-ideal, since for any $f,g \in \a$ there exists an $m \in \NE$ such that $f,g \in F^{\{m\}}$.
And hence $f + g, \s(f) \in F^{\{m\}} \subseteq \a$, as well as $fh \in F^{\{m\}} \subseteq \a$ for any $h \in R$. Furthermore, for $f, g \in R$ with $fg \in \a$ there also exists an $m \in \NE$ such that $fg \in F^{\{m\}}$. 
Then we have $f\s(g) \in F^{\{m+1\}} \subseteq \a$. \\
\indent On the other hand, by induction on the iterative steps $F^{\{n\}}$ it follows that for every mixed $\s$-ideal $\b$ which contains $F$, $F^{\{n\}} \subseteq \b$. Hence, $\a$ is the smallest mixed $\s$-ideal containing $F$. \\
\indent By Lemma \ref{sqrtmixed} we know that $\sqrt{\a}$ is mixed. This actually shows that $\sqrt a$ is indeed the smallest mixed, radical $\s$-ideal of $R$ containing $F$. To see this, assume there exists a radical, mixed $\s$-ideal $\b \supseteq F$
such that $\b \subsetneqq \sqrt{\a}$. Then we have $F \subseteq \a \cap \b \subsetneqq \a$, a contradiction to the minimality of $\a$ (since the intersection of mixed $\s$-ideals is mixed). 
\end{proof}
\end{lem}


\begin{ex} %%not *radical*! 
Let $k$ be a $\s$-field, and consider $R = k\{y_1\}$. Then the $\s$-ideal $[y_1] \si R$ is mixed, hence equal to its mixed closure.
The mixed closure of $[y_1] \cdot [y_1]$ is $[ y_1 \s^i(y_1) \mid i \in \N ] \not \ni y_1$.
One could have expected, perhaps, to get an analog of the statement in algebraic geometry that $\sqrt{F_1  F_2 } = \sqrt{F_1} \cap \sqrt{F_2}$, but this example shows it is not in general so for mixed ideals.
It is however very noteworthy that the ideal $[ y_1 \s^i(y_1) \mid i \in \N ] \si R$ is not radical. For radical, mixed difference ideals we will in fact get such a statement later (Cor. \ref{prod=cap}).
\end{ex}

A very important result in commutative algebra is the fact that every radical ideal is the intersection of prime ideals. This has an analogue for perfect $\s$-ideals, as well as for mixed $\s$-ideals. 
We will prove the latter, but for this we need a few additional tools. We will first prove a weaker version of the statement, for which we need a few results from commutative algebra:

\begin{lem}\label{commalg}
Let $R$ be a ring. 
\begin{itemize}
\item If $S \geq R$ is an overring of $R$, and $\p$ is a minimal prime ideal of $R$, then there exists a minimal prime ideal $\q$ of $S$ such that $\p = \q \cap R$.
\item Every radical ideal of $R$ is the intersection of prime ideals. If $R$ is noetherian, then every radical ideal of $R$ is the intersection of finitely many prime ideals.
\item If $R$ is noetherian and $\p \unlhd R$ is a minimal prime ideal of $R$, then there exists an element $a \in R$ such that $\p$ is the annihilator ideal of $a$, i.e. $\p = \text{Ann}(a) = \{ r \in R \mid ra = 0 \}$.
\end{itemize}
\begin{bew}
See \cite{wibmer} FIXME: not good enough!
\end{bew}
\end{lem}

\begin{defn}
Let $R$ be a difference ring. We say $R$ is \emph{finitely $\s$-generated over $\Z$} if there exists a finite set $A \subseteq R$ so that every $f \in R$ can be written as a finite $\Z$-linear combination of $\s$-powers of elements in $A$. In other words,
for every $f \in R$ there exists an $n \in \NE: f \in \Z[A,\sigma(A),\ldots,\s^n(A)]$. \\ 
\indent For any subset $F \subseteq R$ we denote by $$[F]_{\Z} = \{ f \in R \mid \text{ there exists an } n \in \N: f \in \Z[F, \s(F), \ldots, \s^n(F)] \}$$ the set of all elements $\s$-generated by $F$ over $\Z$.
\end{defn}\index{finitely $\s$-generated over $\Z$}

\begin{prop}\label{mixedintersectionprimesfinite}
Let $R$ be a $\s$-ring finitely $\s$-generated over $\Z$. Then, every radical, mixed $\s$-ideal of $R$ is the intersection of prime $\s$-ideals.
\begin{bew}
Let $\a \si R$ be a mixed, radical $\s$-ideal. By Proposition \ref{bijideals} there is a bijection between the prime $\s$-ideals of $R$ containing $\a$ and those of $R/\a$. We can hence assume without loss of generality, that $\a = [0] \si R$,
 by replacing $R$ with $R/\a$. This means we only have to show that the zero ideal $[0]$ of a well-mixed, reduced $\s$-ring $R$ is the intersection of all its prime $\s$-ideals. Note that this does not change the fact
that $R$ is finitely $\s$-generated over $\Z$. \\
\indent Let thus $f \in R$ be such that $f \in \q \fa \q \si R$ prime. We assert that $f$ then has to be $0$. Assume this is not the case, i.e., $f \neq 0$. Then by assumption on $R$ there is an $n \in \N$ such that $f \in \Z[A,\s(A),\ldots,\s^n(A)]$.
We now use the special case for (algebraic) ideals: since $\Z[A,\s(A),\ldots,\s^n(A)]$ is noetherian and reduced, $(0) \unlhd R$ is the intersection of all prime ideals of $R$. In particular, there exist prime ideals which do not contain $f$.
Let $\q_0 \unlhd \Z[A,\ldots,\s^n(A)]$ be a minimal such prime ideal, i.e., with $f \notin \q_0$. Since $f \in \Z[A,\s(A),\ldots,\s^n(A)] \subset \Z[A,\s(A),\ldots,\s^{n+1}(A)]$, again by Lemma \ref{commalg}, we can find a minimal prime ideal $\q_1 \unlhd \Z[A,\s(A),\ldots,\s^{n+1}(A)]$
such that $\q_1 \cap \Z[A,\s(A),\ldots,\s^{n}(A)] = \q_0$. \\
\indent Inductively we find a chain of minimal prime ideals $\q_i, i \in \N$, $\q_i \unlhd \Z[A,\s(A),\ldots,\s^{n+i}(A)]$, with $\q_{i+1} \cap \Z[A,\s(A),\ldots,\s^{n+i}(A)] = \q_i$ for all $i \in \N$.
Then $\q := \bigcup_{i=0}^{\infty} \q_i$ is a prime ideal of $R$, with $f \notin \q$. In fact, $\q$ is a $\s$-ideal of $R$: Let $a \in \q$. We want to show that $\s(a) \in \q$. By construction of $\q$ there exists an $i \in \N$ such,
that $a \in \q_{i-1} \subseteq \Z[A,\s(A),\ldots,\s^{n+i-1}(A)]$, which implies that $\s(a) \in \Z[A,\s(A),\ldots,\s^{n+i}(A)]$. Lemma \ref{commalg} states then, that there is an $h \in \Z[A,\s(A),\ldots,\s^{n+i}(A)]$ such that $ \q_i = \text{Ann}(h)$.
It follows that $ah = 0$, and since $R$ is well-mixed, this implies that $\s(a)h = 0$, hence, $\s(a) \in \q_i \subseteq \q$. This means that $\q$ is a prime $\s$-ideal of $R$ not containing $f$, which contradicts the assumption on $f$, so that $f = 0$ has to follow.
\end{bew}
\end{prop}

For the general case we need yet another tool, the concept of filters:

\begin{defn}\index{filter}\index{ultrafilter}
Let $U$ be a set, and let $F \subseteq \text{Pot}(U)$, where $\text{Pot}(U)$ denotes the power set on $U$. Then $F$ is called a \emph{filter} if it satisfies the following axioms: 
\begin{itemize}
\item  $U \in F$ and $\emptyset \notin F$.
\item If $V,W \subseteq U$ with $V \subseteq W \text{ and }V  \in F $ it holds that $W \in F$.
\item For $V_1, \ldots, V_n \in F$ it holds that \[ \bigcap_{i = 1}^n V_i \in F. \]
\end{itemize}
A filter $F$ is called an \emph{ultrafilter}, if for any $V \subseteq U$ it holds that $V \in F$ or $U \setminus V \in F$. Note that the first and third axioms together imply that at most one of $V$ and $U \setminus V$ can be in $F$.
\end{defn}



\begin{rem}
Let $U$ be a set. Then, the set of filters on $U$ is inductively ordered by inclusion. By Zorn's lemma, for every filter $F$ on $U$ there must exist a maximal filter $G$ with respect to inclusion such that $F \subseteq G$.
The maximality of the filter implies that $G$ will be an ultrafilter, since we could otherwise find a new filter $G'$ where $G$ is properly included by adding one of the sets which contradict the ultrafilter property and considering the smallest ultrafilter containing this set.
\end{rem}

The reason why this concept is useful in our context is the following:

\begin{lem}\label{lemmafilters}
Let $R$ be a $\s$-ring, and let $M$ be the set of all $\s$-subrings of $R$ which are finitely $\s$-generated over $\Z$. For any fixed subset $F \subseteq R$, consider the set $M_F:= \{ T \subseteq M \mid \{S \in M \mid F \subseteq S \} \subseteq T \} \subseteq \text{Pot}(M)$. 
Then, \[ \mathcal{F}:= \bigcup_{ F \subseteq R \text{ finite} } M_F \]
 defines a filter on $M$. If $\mathcal{G}$ is an ultrafilter containing $\mathcal{F}$, and $P:= \prod_{S \in M} S$ with component-wise operations,
 then the ultrafilter $\mathcal{G}$ defines an equivalence relation on $P$ via $(g_S)_{S \in M} \sim (h_S)_{S \in M} : \Leftrightarrow \{ S \in M \mid g_S = h_S \} \in \mathcal{G}$. 
The set of equivalence classes $P/\mathcal{G}:= P/\textsim$ has a natural $\s$-ring structure and is called an ultraproduct. %%fixme: of what?
\begin{proof}
Let us first show that $\mathcal{F}$ is a filter. For $F \subseteq R$ finite we have $[F]_{\Z} \in \{ S \in M \mid F \subseteq S \} \neq \emptyset$, and since $T \supseteq \{ S \in M \mid F \subseteq S \} \fa T \in M_F$, $\emptyset \notin M_F$ (Note that $[\emptyset]_\Z = (0)$, so it also holds for $F = \emptyset$).
  That $M \in M_F$ for any $F \subseteq R$ is obvious, as well as that for $T \subseteq U, T \in M_F$ it holds that $U \in M_F$. \\ 
\indent We only need to show that $U,T \in \mathcal{F}$ implies that $U \cap T \in \mathcal{F}$.
  Let $\hat U, \hat T \subseteq R$ be finite, such that $U \in M_{\hat U}, T \in M_{\hat T}$. $\hat U \cup \hat T \subseteq R$ is also finite and it holds that  $\{ S \in M \mid \hat U \cup \hat T \subseteq S \} \subseteq \{ S \in M \mid \hat U \subseteq S \} \subseteq U$,
 and similarly for $T$. This means that $U \cap T \in M_{\hat U \cup \hat T} \subseteq \mathcal{F}$, which finishes the proof that $\mathcal{F}$ is a filter. \\

 Now, consider an ultrafilter $\mathcal{G} \supseteq \mathcal{F}$ and define $\sim$ on $P$ as above. This is an equivalence relation: Let $f \sim g, g \sim h$ for $f,g,h \in P$. 
 This means that $\{ S \in M \mid f_S = g_S \} \in \mathcal{G}, \{ S \in M \mid g_S = h_S \} \in \mathcal{G}$. But then $$\{ S \in M \mid f_S = g_S \} \cap \{ S \in M \mid g_S = h_S \} \subseteq \{ S \in M \mid f_S = h_S \} \in \mathcal{G},$$
 since $\mathcal{G}$ is a filter.
 Reflexivity follows from the fact that $M \in \mathcal{G}$, and symmetry is obvious. \\
\indent  We now only need to show that we have a well-defined $\s$-ring structure on $P/\textsim$.
 Consider $f,f' \in P$ with $f \sim f'$. We have that for all $S \in M$ with $f_S = f'_S$:  $\sigma(f)_S = \sigma(f')_S$. 
 But then $\{ S \in M \mid \s(f)_S = \s(f')_S \} \supseteq \{ S \in M \mid f_S = f'_S \} \in \mathcal{G}$ by assumption, and since $\mathcal{G}$ is a filter, this means that $\{ S \in M \mid \s(f)_S = \s(f')_S \} \in \mathcal{G}$,
 hence $\s(f) \sim \s(f')$. That $+$ and $\cdot$ are also well-defined can be proven in an analogous fashion.
\end{proof}
\end{lem}

We can now turn our attention to the generalization of Proposition \ref{mixedintersectionprimesfinite}. 


\begin{theorem}\label{intersectionprimes}
Let $R$ be a $\s$-ring and $F \subseteq R$ be a subset of $R$. Then, 
\begin{align*} \{F\}_m = \bigcap_{\substack{F \subseteq \p \si R \\ \p \text{ prime}}} \p \end{align*}
In particular, every radical, mixed $\s$-ideal of $R$ is the intersection of prime $\s$-ideals.
\begin{bew}
It suffices to show that every radical, mixed $\s$-ideal of $R$ is the intersection of prime $\s$-ideals.
Indeed, since prime $\s$-ideals are radical and mixed, it is clear that $\{F\}_m \subseteq \p$ for every prime $\p \si R$ with $F \subseteq \p$, which together with the fact that every radical, mixed $\s$-ideal of $R$ is the intersection of prime $\s$-ideals gives the representation 
\begin{align*} \{F\}_m = \bigcap_{\substack{F \subseteq \p \si R \\ \p \text{ prime}}} \p. \end{align*}
Now, by the same argument as in the beginnig of the proof of Proposition \ref{mixedintersectionprimesfinite}, it is enough to prove in the case that $R$ is well-mixed and reduced, that the intersection of all prime $\s$-ideals is $[0]$.
Let $0 \neq f \in R$. We will construct a prime $\s$-ideal $\q$ of $R$ which does not contain $f$: 

Let $P/\mathcal{G}$ be the difference ring as in Lemma \ref{lemmafilters}. Consider the mapping $\varphi: R \rightarrow P/\mathcal{G}, g \mapsto (g_S)_{S \in M}$ with $(g_S) = g \fa S \in M$ with $g \in S$ and $(g_S) = 0$ for $g \notin S$. 
It is in fact $\{ S \in M \mid g \in S \} \in M_{\{g\}}$ (with $M_{\{g\}}$ as in Lemma \ref{lemmafilters}). This means that the image of the mapping onto $P/\mathcal{G}$ is in fact independant of the $(g_S)$ for $g \notin S$, as any other choice of these would be in the same $\sim$ class as the image described above.
It follows that $\varphi$ is a well-defined morphism of $\s$-rings. \\
\indent From Proposition \ref{mixedintersectionprimesfinite} we know that for every $S \in M$, there exists a prime $\s$-ideal $\p_S \si S$ such that $f \notin \P_S$. 
We define $\p \subseteq P/\mathcal{G}$ as the set of all equivalence classes of elements $(g_S)_{S \in M}$ such that $\{ S \in M \mid g_S \in \p_S \} \in \mathcal{G}$. 
For $[(g_S)_{S \in M}]_{\sim}, [(h_s)_{S \in M}]_{\sim} \in \p$ we have $$ \mathcal{G} \ni \{ S \in M \mid  g_S \in \p_S \} \cap  \{ S \in M \mid  h_S \in \p_S \} \subseteq \{ S \in M \mid  g_S + h_S \in \p_S \} \in \mathcal{G},$$
since $\mathcal{G}$ is a filter. Similar arguments for $\s(g), gh$ for $h \in P/\mathcal{G}$ show that $\p$ is indeed a $\s$-ideal. $\p$ is also prime since $\mathcal{G}$ is an ultrafilter:
Let $g,h \in P$ with $\{ S \in M \mid g_Sh_S \in \p_S \} \in \mathcal{G}$. If $[g]_\sim \notin \p$, then $V:= \{ S \in M \mid g_S \in \p_S \} \notin \mathcal{G}$. Since $\mathcal{G}$ is an ultrafilter, 
this means that $M \setminus V \in \mathcal{G}$. But $$\mathcal{G} \ni (M \setminus V) \cap \{ S \in M \mid g_S h_S \in \p_S \} \subseteq \{ S \in M \mid h_S \in \p_S \} \in \mathcal{G},$$
which means that $[h]_\sim \in \p$. The preimage of a prime $\s$-ideal, $\q := \varphi^{-1}(\p) \si R$ is also prime. By construction, $[\varphi(f)]_\sim \notin \p$, which means that $f \notin \varphi^{-1}(\p)$, as desired. 

\end{bew}
\end{theorem}

\subsection{An Analog of the Cohn Topology}

\begin{defn}
Let $R$ be a $\s$-ring. We denote the set of all prime $\s$-ideals of $R$ by $\s$-$\Spec(R):= \{ \p \si R \mid \p \text{ prime }\}$. Similarly, we denote the set of $\s$-prime ideals by $\Spec^\s(R):= \{ \p \si R \mid \p ~ \s\text{-prime }\}$.
\index{$\s$-$\Spec$} \index{$\Spec^\s$}
\end{defn}


\begin{rem}
As is the case with $\Spec^\s(R)$, it can be the case that $\s$-Spec($R)= \emptyset$. For example, let $R$ be a $\s$-ring, and consider the $\s$-ring $R \oplus R$, with $\s( (r,s)):= (\s(s),\s(r))$. 
We will show that this ring has no prime $\s$-ideals. Let $\p \unlhd R$ prime. Then $0 = (1,0)(0,1) \in \p$, which means that either $(1,0) \in \p$ or $(0,1) \in \p$. But then $R \oplus 0 \subseteq \p$ or $0 \oplus R \subseteq \p$. If we assume that $\p$ is a $\s$-ideal then
 this implies that $R \oplus R \subseteq \p$, which cannot be, by definition.
\end{rem}

In algebraic geometry, one usually considers $\Spec(R)$ as a topological space with a topology called the Zariski topology. This has an analog for $\Spec^\s(R)$, usually called the Cohn topology. Here we will develop a further analog of both,
 which we will define on $\s$-Spec$(R)$, and will be the ``right'' topology for working with radical, mixed $\s$-ideals, as we shall see by its many properties.

\begin{defn}
Let $R$ be a $\s$-ring and $F \subseteq R$ be a subset of $R$. Then we define $\Vm (F):= \{ \p \in \s$-Spec$(R) \mid F \subseteq \p \}$. 
%%Similarly, for a subset $A \subseteq \s$-Spec$(R)$ we set $\I(A):= \{ r \in R \mid 
\end{defn}

\begin{lem}\label{topologywelldef}
Let $R$ be a $\s$-ring. Then we have:
\begin{enumerate}[(a)]
\item $\Vm((0)) = \s$-Spec$(R)$, and $\Vm(R) = \emptyset$.
\item For any two ideals $\a,\b \unlhd R$ we have $\Vm(\a) \cup \V(\b) = \Vm(\a \cap \b).$
\item For any family of ideals $(\a_i)_{i \in I}$ for an index set $I$, we have $$\bigcap_{i \in I} \Vm(\a_i) = \Vm(\sum_{i \in I} \a_i).$$ \label{vmintersectionideals}
\end{enumerate}
\begin{bew}
\begin{enumerate}[(a)]
\item We have $(0) \subseteq \p \fa \p \in \sSpec(R)$, as well as $R \not\subseteq \p \fa \p \in \sSpec(R)$.
\item Let $\a, \b \unlhd R$ be two ideals in $R$. Then $\Vm(\a) \cup \Vm(\b) \subseteq \Vm(\a \cap \b)$, since for $\p \si R$ prime, $\a \subseteq \p$ it follows that $\a \cap \b \subseteq \p$, and similarly for $\b$.
On the other hand, let $\p \si R$ prime with $\a \cap \b \subseteq \p$, and $\a \not\subseteq \p$ (otherwise $\p \in \Vm(\a)$ and we are done). Then there exists an $f \in \a$, $f \notin \p$. 
For any $g \in \b$, it follows that $fg \in \a \cap \b \subseteq \p$. Since $\p$ is prime, this means that $g \in \p$, hence $\b \subseteq \p$, which concludes the proof.
\item Let $(\a_i)_{i \in I}$ be a family  of ideals of $R$. Then $$\p \in \bigcap_{i \in I} \Vm(\a_i) \Leftrightarrow \a_i \subseteq \p \fa i \in I \Leftrightarrow \p \in \Vm(\sum_{i \in I} \a_i).$$
\end{enumerate}
\end{bew}
\end{lem}


\begin{rem}\label{vmsequal}
Since for a $\s$-ring $R$ any prime $\s$-ideal of $R$ is radical and mixed, it holds that for any $F \subseteq R$, and any prime $\s$-ideal $\p \si R$ with $F \subseteq \p$ we have
$(F) \subseteq [F] \subseteq \{ F \}_m \subseteq \p$. In particular, this means that $\Vm(F) = \Vm((F)) = \Vm([F]) = \Vm(\{F\}_m)$. If $F$ has only one element $f$, we write $\Vm(f)$ for $\Vm(F)$.
\end{rem}

\begin{defn}\label{deftop}
Let $R$ be a $\s$-ring. We define a topology on $\sSpec(R)$ by setting $A \subseteq \sSpec(R)$ closed $:\Leftrightarrow A = \Vm(\a)$ for an ideal $\a \unlhd R$, or equivalently,
 by defining a set to be open, if it is a complement of such a $\Vm(\a)$. This is well-defined thanks to Lemma \ref{topologywelldef}.
For $f \in R$ we set $$\s\text{-D}(f):= \sSpec(R) \setminus \Vm(f).$$ By Remark \ref{vmsequal}, $\s$-$D(f)$ is the complement of a closed set, and hence, open. 
We call the sets of the form $\s$-D$(f) \subseteq \sSpec(R)$ basic open subsets of $\sSpec(R)$.
\end{defn}

From here on, if not explicitly stated otherwise, when referring to topological concepts on $\sSpec(R)$ we will be referring to the topology just defined.

\begin{rem}
From its definition it is clear that $\sSpec(R) \subseteq \Spec(R):= \{ I \unlhd R \mid I \text{ prime} \}$. Since Lemma \ref{topologywelldef} does not require the ideals to be $\s$-ideals, 
it is easy to conclude that in fact the topology on $\sSpec(R)$ is just the topology induced by restriction of the Zariski topology to $\sSpec(R)$. The same argument can be made to see that the Cohn topology in turn,
defined on $\Spec^\s(R) = \{ \p \si R \mid $ $\p$ $ \s$-prime $\} \subseteq \sSpec(R)$, is also the restriction of the topology defined on $\sSpec(R)$. 
\end{rem}

\begin{defn}
Let $X$ be a topological space.
\begin{enumerate}[(a)]
\item  We say that $X$ is \emph{irreducible} if $X = X_1 \cup X_2$ with $X_1, X_2$ closed implies that $X = X_1$ or $X = X_2$. 
$X_1 \subseteq X$ is called \emph{irreducible} if it is an irreducible topological space with the topology induced by the restriction to $X_1$.\index{irreducible topological space}
\item Let $Y \subseteq X$ be closed. We say that a point $f \in Y$ is a \emph{generic point} of $Y$, if $\overline{\{  f \} } = Y$, where for $A \subseteq X$, $\overline{A}$ denotes the closure of $A$. \index{generic point}
\end{enumerate}
\end{defn}

\begin{prop}
Let $R$ be a $\s$-ring. We have:
\begin{enumerate}[(a)]
\item \label{vmbijection} The mapping 
$$\{ \a \si R \mid \a\text{ mixed and radical }\} \rightarrow \{ A \subseteq \sSpec(R) \mid A \text{ closed }\}, \a \mapsto \Vm(\a)$$
 is bijective and order-reversing.
\item \label{irred=prime} For $F \subseteq R$ it holds that $\Vm(F)$ is irreducible if and only if $\{F\}_m$ is prime.
\item $\sSpec(R)$ is quasi-compact.
\item The basic open sets $\{ \s$-D$(f) \mid f \in R \}$ form a basis for the topology on $\sSpec(R)$.
\item Every irreducible closed subset $Y$ of $\sSpec(R)$ has a unique generic point $y$.
\end{enumerate}
\begin{bew}
\begin{enumerate}[(a)]
\item \label{orderreversingbij} That the mapping is order-reversing is obvious. The injectivity follows from the fact that by Theorem \ref{intersectionprimes} $\a = \bigcap_{\a \subseteq \p \in \sSpec(R)} \p$. By Remark \ref{vmsequal} we obtain the surjectivity,
 since $\Vm(\a) = \Vm(\{\a\}_m)$.
\item Since $\Vm(F) = \Vm(\{F\}_m)$, we can assume without loss of generality, that $F \si R$ is a radical, mixed $\s$-ideal.
For the first implication, ``$\Leftarrow$'', let $F \si R$ be prime, and $\Vm(F) = \Vm(\a) \cup \Vm(\b)$ with radical, mixed $\s$-ideals $\a, \b$. Assume that $\Vm(F) \not\subseteq \Vm(\a)$. Then by (\ref{orderreversingbij}), $\a \not \subseteq F$, so there exists an $a \in \a$, with $a \notin F$.
For any $b \in \b$ we then have $ab \in \p \fa \p \in \V(F) = \Vm(\a) \cup \Vm(\b)$, and with Theorem \ref{intersectionprimes} we get $ab \in F = \bigcap_{\p \in \Vm(F)}\p$. By assumption, $F$ is prime and $a \notin F$, which implies
 that  $b \in F$. But this means that $\b \subseteq F$, and thus $\Vm(F) \subseteq \Vm(\b)$, which shows the irreducibility. \\
\indent Now, for the other implication, ``$\Rightarrow$'', assume that $\Vm(F)$ is irreducible, and let $a,b \in R$ with $ab \in F$. Consider $F \subseteq \p \in \Vm(F)$. Then $ab \in \p$, 
which means that $a \in \p$ or $b \in \p$, since $\p$ is prime. This implies that $\p \in \Vm(\{a\}_m) \cup \Vm(\{b\}_m)$, which also means that $\Vm(F) \subseteq \Vm([a]) \cup \Vm([b])$.
Now, by assumption, $\Vm(F)$ is irreducible, and thus it has to be that $\Vm(F) \subseteq \Vm([a])$ or $\Vm(F) \subseteq \Vm([b])$. By the bijectivity of the mapping in (\ref{orderreversingbij}) this means that $a \in F$ or $b \in F$.
\item Let $\Vm(\a_i)_{i \in I}$ be a family of closed sets, $\a_i \si R$ mixed, radical for all $i \in I$, satisfying that 
$\bigcap_{i \in J} \Vm( a_i) \neq \emptyset$ for every finite $J \subseteq I$. By  going to the complement of open sets, being quasi-compact is equivalent to the implication that $\bigcap_{i \in I} \Vm(a_i) \neq \emptyset$.
By Lemma \ref{topologywelldef} we see that $\bigcap_{i \in I} \Vm( \a_i) = \Vm ( \sum_{i \in I} \a_i)$. Assume that $ \Vm ( \sum_{i \in I} \a_i) = \emptyset$. 
By Theorem \ref{intersectionprimes} this means that $\{ \sum_{i \in I} \a_i \}_m = R$. In particular, $1 \in \{ \sum_{i \in I} \a_i \}_m$. By the construction in Lemma \ref{lemshuffling} (and with the notation used there), this means that there has to be an $n \in \NE$,
so that $1 \in (\sum_{i \in I} \a_i )^{\{n\}}$. In particular, this means that $1$ can be written as a finite $R$-linear combination $\sum_{k=1}^l r_k a_k$ with $a_k \in (\sum_{i \in I} \a_i )^{\{n\}}, r_k \in R, k = 1,\ldots,l$. In particular, there exists a $J \subseteq I$ finite,
such that $a_k \in (\sum_{i \in J} \a_i )^{\{n\}}$ for all $k \in \{1, \ldots, l \}$. But this implies that $1 \in (\sum_{i \in J} \a_i)^{\{n\}}$, meaning that $\Vm(\sum_{i \in J} \a_i) = \emptyset$, a contradiction. 
\item For an open subset $U \subseteq \sSpec(R)$ there exists by definition an $\a \si R$ such that $U = \sSpec(R) \setminus \Vm(\a)$. We can then write $U$ as a union of basic open sets as follows: $$U = \bigcup_{a \in \a} \s\text{-D}(a).$$
\item By (\ref{irred=prime}), an irreducible closed subset $A$ of $\sSpec(R)$ has the form $A = \Vm(\p)$, for $\p \si R$ prime. This prime $\s$-ideal $\p$ is the unique generic point of $A$.
To see this, consider the closure of $\p$: $$\overline{\{\p\}} = \bigcap_{\{\p\} \subseteq \Vm(F)}\Vm(F).$$ From the definition of $\Vm(F)$ it holds that $\{\p\} \subseteq \V_m(F)$ if and only if $F \subseteq \p$. By Lemma \ref{topologywelldef} (\ref{vmintersectionideals}), and the obvious fact that we can restrict the intersection to $\s$-ideals, we get thus
\[ \overline{\{\p\}} \bigcap_{F \subseteq \p}\Vm(F) = \Vm(\sum_{F \subseteq \p, F \si R} F) = \Vm(\p) = A \]
\end{enumerate}
\end{bew}
\end{prop}

\clearpage
\section{Difference Varieties}


In this section we will introduce difference varieties. We will do so in a way that they correspond with the topology on $\sSpec(R)$, which we defined in the previous section. It will be again based on M. Wibmer's lecture notes \cite{wibmer}, 
where it is worked out for the analogous case of perfect $\s$-ideals.

\begin{defn}
Let $A$ be a $\s$-ring. If $A$ is (algebraically) an integral domain, we call $A$ an \emph{integral $\s$-ring}. If the endomorphism $\s$ on $A$ is injective, then we call $A$ a \emph{$\s$-domain}. \index{integral $\s$-ring} \index{$\s$-domain}
\end{defn}

\begin{rem}\label{sdomain=field}
Let $A$ be a $\s$-domain. Then $k:=$Quot$(A)$ is a $\s$-field: For $\frac{r}{s} \in k$ we can define $\s(\frac{r}{s}):= \frac{\s(r)}{\s(s)}$. Since $\s$ is injective, it holds that $\s(s) \neq 0$ for $s \neq 0$, which implies that $\s$ is well defined.
By this argument we see that in general for an integral $\s$-ring $A$ Quot$(A)$ is a $\s$-field (in this natural way) if and only if $A$ is a $\s$-domain.
\end{rem}

Our main purpose, in a first instance at least, is to investigate the properties of solutions to difference equations. 
We will start with an integral $\s$-field $k$ and look for solutions (zeros) of some $\s$-polynomial $p$ over $k$, i.e. $p \in k\{y_1, \ldots, y_n \}$. In general, rather, it will be a set of $\s$-polynomials $F \subseteq k\{y_1, \ldots, y_n \}$ that we will study. 
For this we want to define $\s$-varieties; we cannot mimic the usual approach from algebraic geometry, where we would take the algebraic closure of $k$. The next remark shows why.

\begin{rem}\label{incompatibleextensions}
 Consider the constant $\s$-field $\Q$ and $K = \Q(\sqrt{2})$, with $\s (\sqrt{2}) = \sqrt{2}$; $L = \Q(\sqrt{2}), \s(\sqrt{2}) = - \sqrt{2}$. 
Both $K$ and $L$ are $\s$-field extensions of $\Q$, but there cannot be a further extension $\Q \leq M$ of $\s$-fields, such that $K,L \leq M$ are both (isomorphic to) $\s$-subfields of $M$. 
To see this, assume there was such an $M$. Then the set $\{ a \in M \mid a^2 - 2 = 0 \}$ has exactly two elements, which we will call $\sqrt{2}, -\sqrt{2}$ (since $\sqrt{2} + (- \sqrt{2}) = 0$).
But $\sqrt{2} \in K$ has to be mapped to one of these two in any embedding, and the same for $\sqrt{2} \in L$, which already yields the contradiction,
 since in $M$ either $\s(\sqrt{2}) = \sqrt{2}$ or $\s(\sqrt{2}) = -\sqrt{2}$.
\end{rem}

To avoid this problem, we will define $\s$-varieties as functors. For this we will need a few category-theoretic definitions:

\begin{defn}
Let $k$ be a $\s$-field. The category of all $\s$-ring extensions $A \supseteq k$ we denote by $\sringk$, where the morphisms are defined as follows: For $B,C \in \sringk$ we say that a morphism of $\s$-rings $\varphi: B \rightarrow C$ is a morphism of $\s$-ring extensions of $k$, if and only if, $\varphi_{|A} = \id_A$.
The subcategory which arises from restricting the object class to integral $\s$-rings, the class of integral $\s$-ring extensions of $A$, we denote by $\sintk$. \index{$\sintk$} \index{$\sringk$}
\end{defn}

Now we are ready to define $\s$-varieties of $\s$-rings, with mixed $\s$-ideals in mind:

\begin{defn}\label{defnVV}
Let $k$ be a $\s$-field and $B \in \sintk$ an integral $\s$-overring of $k$. Further let $F \subseteq k\{y_1, \ldots, y_n\}$ be a set of $\s$-polynomials over $k$. 
Then we define $\VV_B(F):= \{ b \in B^n \mid f(b) = 0 \fa f \in F \}$. We denote as a \emph{$\s$-variety over $k$}, or a \emph{$k$-$\s$-variety} a functor $X: \sintk \rightarrow \Set$, for which there exists a set $F \subseteq k\{y_1, \ldots, y_n \}$ such that $X(B) = \VV_B(F)$ for all $B \in \sintk$.
Here, $\Set$ denotes the usual category of sets with mappings as morphisms. We also write $X := \VV(F)$ as a short notation for this functor. \index{$\s$-variety} \index{$\s$-variety over $k$} \index{$k$-$\s$-variety}
\end{defn}

\begin{defn}
Let $k$ be a $\s$-field and $X: \sintk \rightarrow \Set$ be a $k$-$\s$-variety. We say a subfunctor $Y \subseteq X$ is a \emph{$\s$-subvariety} of $X$, if $Y$ is a $k$-$\s$-variety itself. \index{$\s$-subvariety}
\end{defn}

 \begin{rem}
Let $k$ be a $\s$-field and $X$ be a $k$-$\s$-variety. Not every subfunctor of $X$ is a $\s$-subvariety. Consider the functor $X = \VV(0)$, for $\{0\} \subset k\{y_1\}$.
This means that for $B \in \sintk$, $B \mapsto B\setminus \{0\}$ is a subfunctor $Y$ of $X$ (since $B \setminus \{ 0 \} \subset B \fa B \in \sintk$), but $Y$ is not a $\s$-variety:
there exists no $F \subseteq k\{y_1\}$ such that $\VV_B(F) = B \setminus \{ 0 \} \fa B \in \sintk$: indeed, assume there was such an $F$, and let $0 \neq f \in F$. Then $f(b) = 0 \fa b \in B$ and $\fa B \in \sintk$. In particular,
$k\{y_1\} \in \sintk$ satisfies that $f(y_1) = f = 0$, a contradiction.  FIXME: not a functor
\end{rem}

\begin{defn}\label{defnI}
Let $X = \VV(F)$ be a $\s$-variety over the $s$-field $k$, $F \subseteq k\{y_1,\ldots,y_n\}$. Then we set $$\I(X):= \{ f \in k\{y_1,\ldots,y_n \mid f(b) = 0 \fa b \in \VV_B(F), ~ B \in \sintk \}.$$ \index{ $\I(X)$}
\end{defn}

\begin{ex}\label{A^n}
Let $k$ be a $\s$-field and consider the set $\{ 0 \} = F \subseteq k\{y_1,\ldots,y_n\}$. Then the $\s$-variety $X$ defined by $F$, $X(B) = \VV_B(F) \fa B \in \sintk$ is called the affine $n$-space, and is denoted by $\mathbb{A}^n_k$, 
or simply $\mathbb{A}^n$, whenever $k$ is clear from the context. Then for every $G \subseteq A\{y_1,\ldots,y_n\}$ the $\s$-variety given by $Y: B \mapsto \VV_B(G)$ is a $\s$-subvariety of $\mathbb{A}^n$, 
and we write $Y \subseteq \mathbb{A}^n$.
\end{ex}

We note that $0$ is in any (radical, mixed, difference) ideal, so it is not surprising that every $\s$-variety is a $\s$-subvariety of $\VV(0)$. This ``intuition'' will be made more concrete later on.

Since we have this functorial definition, we have in principle a whole proper class of solutions for most systems of difference equations. 
It is obvious we want to have some sort of equivalence relation between solutions to group them up in a reasonable manner.

\begin{defn}\label{equivsols}
Let $k$ be a $\s$-field, $B,C \in \sintk$. Further let $F \subseteq k\{y_1,\ldots,y_n\}$ be a system of difference equations and $b \in B^n, c \in C^n$ be solutions of $F$, i.e. $b \in \VV_B(F), c \in \VV_C(F)$.
We say that $b$ and $c$ are equivalent iff the mapping $b \mapsto c$ is a well-defined isomorphism between the integral $\s$-rings $k\{b\}$ and $k\{c\}$  (as elements of $\sintk$). \index{equivalent solutions}
\end{defn}

%% \begin{lem}
%% Let $k$ be a $\s$-field, $B,B' \in \sintk$, and let $b \in B^n; b' \in B'^n$ be equivalent solutions for a system of difference equations $F \subseteq A\{y_1,\ldots,y_n\}$
%% \end{lem}

\begin{rem}
The usual approach, for example in \cite{cohn} and \cite{levin}, is to restrict the definition of $\s$-varieties to (certain) $\s$-fields instead of allowing any integral $\s$-rings. With this concept,
two solutions $a,b$ of a system of difference equation over a difference field $k$ are equivalent in the sense of Definition \ref{equivsols} iff the $\s$-field extensions $k\langle a \rangle$ and $k\langle b \rangle$ are isomorphic as $\s$-field extensions of $k$ via $a \mapsto b$.
This is also in accordance to the usual definition of equivalence, see Ch. 2 of \cite{wibmer}. FIXME: check references!
\begin{bew}
By definition, there have to be $\s$-field extensions $k \leq A,B$ such that $a \in A^n$, $b \in B^n$. Since $A,B$ are $\s$-fields, it means that $k\{a\}$ and $k\{b\}$ are $\s$-domains, 
and $k\langle a \rangle, k\langle b \rangle$ have the ``canonical'' difference structure induced by $k\{a\}, k\{b\}$ (see Remark \ref{sdomain=field}). Let $\varphi: k\{a\} \rightarrow k\{b\}, a \mapsto b$ be an isomorphism of integral $\s$-ring extensions of $k$.
Then we can define $\tilde \varphi: k \langle a \rangle \rightarrow k\langle b \rangle, \frac{x}{y} \mapsto \frac{\varphi(x)}{\varphi{(y)}}$. This is a well-defined isomorphism of $\s$-field extensions of $k$, since:
\begin{align*}
\tilde \varphi \left(\s \left(\frac{x}{y}\right)\right) = \tilde \varphi \left( \frac{\s \left(x\right)}{\s \left(y\right)}\right) = \frac{ \varphi \left(\s \left(x\right)\right)}{ \varphi \left(\s \left(y\right)\right)} =  \frac{\s \left(\varphi \left(x\right)\right)}{\s \left(\varphi \left(y\right)\right)} = \s \left( \tilde \varphi \left(\frac{x}{y}\right)\right)
\end{align*}
The inverse implication is obvious.
\end{bew}
\end{rem}

\begin{ex}
In the two $\s$-field extensions of $\Q$ in Remark \ref{incompatibleextensions} we have two solutions of the (algebraic) polynomial $y^2-2$, which represent two different solutions in the difference algebraic sense,
since the $\s$-fields $\Q(\sqrt{2}), \s(\sqrt{2}) = \sqrt{2}$ and $\Q(\sqrt{2}), \s(\sqrt{2}) = -\sqrt{2}$ are not isomorphic. 
\end{ex}

\begin{ex}
Let $k$ be a $\s$-field. The $\s$-variety $X$ given by $\s(y) \in k\{y\}$, i.e. $X(B) = \VV_B(\s(y)) \fa B \in \sintk$ has a single point in any $\s$-field extension of $k$, namely $0$. However, in general integral $\s$-rings,
this is not necessarily the case: Take, for example, $B:= k\{y\}/[\s(y)] \in \sintk$. In $B$ we have $0 \neq $ ker$(\s) = [y] \si B$, which means that in particular, $[y] \subseteq \VV_B(\s(y))$.
\end{ex}

It is not a coincidence that in the previous example we found more solutions on the $\s$-ring $B = k\{y\}/[\s(y)]$. The $\s$-ideal $[\s(y)]$ is radical and mixed, i.e., $[\s(y)] = \{ [\s(y)] \}_m$.
In fact, the ring $B$ as we chose it plays an analogous role to that of the coordinate ring of an affine variety in the usual (algebraic) case.

The next proposition shows why our definition of $\s$-variety is ``the right one'' for mixed ideals:

\begin{prop}\label{I=F_m}
Let $k$ be a $\s$-field and $X = \VV(F) \subseteq \mathbb{A}^n$ be a difference variety over $k$. Then $\I(X) = \{F\}_m \si k\{y_1,\ldots,y_n\}$. 
\begin{bew}
We will first show that $\I(X)$ is a radical, mixed $\s$-ideal.
Let $f, g \in \I(X)$, $h \in k\{y_1,\ldots,y_n\}$. Then, for every $B \in \sintk$, $b \in \VV_B(F)$, we have $f(b) = g(b) = 0$.
It follows that $(f + g)(b) = f(b) + g(b) = 0$ as well as $(fh)(b) = f(b)h(b) = 0 \cdot h(b) = 0$ and $\s(f)(b) = \s(f(b)) = \s(0) = 0$, so that $\I(X)$ is a $\s$-ideal.
It further follows that $h(b)^n = 0$ implies $h(b) = 0$, since $B$ is an integral domain, and this means that $h^n \in \I(X)$ implies that $ h \in \I(X)$. \\
\indent It only remains to show that $\I(X)$ is mixed. Let now $f,g \in k\{y_1,\ldots,y_n\}$ be such that $fg \in \I(X)$. This means that for all  $B \in \sintk$, $b \in \VV_B(F)$: $(fg)(b) = f(b) g(b) = 0$. Since $B$ is an integral domain,
this implies that $f(b) = 0$ or $g(b) = 0$. But that also implies that $\s(f(b)) = \s(0) = 0$, or $\s(g(b)) = 0$, so that in any case $(f\s(g))(b) = 0$, from which it follows that $f\s(g) \in \I(X)$.
Note that it does not always have to be the same case, $f(b) = 0$ or $g(b) = 0$, as it depends on $B$. In particular, $\I(X)$ does not have to be prime in general. We thus see that $\I(X)$ is radical and mixed, hence $\{F\}_m \subseteq k\{y_1,\ldots,y_n\}$. \\
\indent For the other inclusion, let $f \in \I(X)$. We will show that $f \in \{F\}_m$. Let $F \subseteq \p \si k\{y_1,\ldots,y_n\}$ be a prime $\s$-ideal.
Then, consider $B:= k\{y_1,\ldots,y_n\}/\p$: this is an integral $\s$-ring. Since $F \subseteq \p$, we know that $y + \p \in \VV_B(F)$. By assumption we have $f \in \I(\VV(F))$, which means by definition that $f(y + \p) = 0$, which
in turn means that $f \in \p$. But by Theorem \ref{intersectionprimes} this implies that $f \in \{F\}_m$.
\end{bew}
\end{prop}

From this we immediately get a further result on radical, mixed ideals, which is analogous to the case for radical ideals in algebraic geometry.
\begin{cor}\label{prod=cap}
Let $\a \neq 0 \neq \b \si k\{y\}$ be two non-trivial, radical, mixed difference ideals. Then it holds that $\a \cap \b = \{ \a \b \}_m$.
\begin{bew}
Since $\a, \b$ are radical and mixed, we know from Proposition \ref{I=F_m} that $\a = \I(\VV(\a)), \b = \I(\VV(\b))$, and $\{ \a \b \}_m = \I( \VV( \a \b ))$.
For any $B \in \sintk$, it holds that:
\begin{align*} \VV_B( \a \b) = \VV_B( \a) \cup \VV_B( \b) \end{align*}
The inclusion ``$\supseteq$'' is obvious. For ``$\subseteq$'', let $p \in \VV_B(\a\b)$ and assume there exisits an $f \in \a$ such that $f(p) \neq 0$.
Then, by definition of $\VV_B(\a\b)$, it holds that $f(p)g(p) = 0 \fa g \in \b$. This means, however, that $p \in \VV_B(\b)$ (since $B$ is an integral domain). The other case is completely analogous.
Since this holds for any $B$, the $\s$-varieties are also equal: $\VV( \a \b) = \VV( \a) \cup \VV( \b)$. Now,
\begin{align*} \I(\VV(\a \b)) = \I(\VV(\a) \cup \VV(\b)) \\ = \{ f \in k\{y\} \mid f(p) = 0 \fa p \in \VV_B(\a) \cup \VV_B(\b), ~ B \in \sintk \} \end{align*}
And $f(p) = 0 \fa p \in \VV_B(\a) \cup \VV_B(\b), ~ B \in \sintk$, is equivalent to \\
$ \underbrace{f(p) = 0 \fa p \in \VV_B(\a), ~ B \in \sintk}_{\Leftrightarrow f \in \I(\VV(\a))}$ and $ \underbrace{f(p) = 0 \fa p \in \VV_B(\b), ~ B \in \sintk}_{\Leftrightarrow f \in \I(\VV(\b))}$. \\
Hence, $\{\a\b\}_m = \I(\VV( \a \b)) = \I(\VV(\a)) \cap \I(\VV(\b)) = \{\a\}_m \cap \{\b\}_m = \a \cap \b$.
\end{bew}
\end{cor}

\begin{defn}
Let $k$ be a $\s$-field and let $X$ be a $\s$-variety over $k$. Further let $F \subseteq k\{y_1, \ldots, y_n\}$ be a system of difference equations over $k$ with $X(B) = \VV_B(F) \fa B \in \sintk$.
Then we define the $\s$-ring $k\{y_1, \ldots, y_n\}/\{F\}_m = k\{y_1, \ldots, y_n\}/\I(X) =: k\{X\}$ and call it the \emph{coordinate ring} of $X$. Since $\{F\}_m$ is a radical, mixed $\s$-ideal, $k\{X\}$ is reduced and well-mixed. \index{coordinate ring}
\end{defn}

\begin{rem}
Let $k$ be a $\s$-field and $X$ a $k$-$\s$-variety. Further let $b \in X(B), ~ B \in \sintk, f + \I(X) \in k\{X\}$. Then the value of $f(b) \in k$ is independent of the representative of $f$,
since for $f' + \I(X) = f + \I(X)$, we know that $f - f' \in \I(X)$, and thus by definition, $(f - f')(b) = 0$. By abuse of notation,
we will sometimes use the representative $f$ to refer to its equivalence class $f + \I(X)$ and we will simply write $f(b)$ to mean the well-defined value of evaluating $b$ on any representative of the class.
\end{rem}

We can now clarify what we meant after Example \ref{A^n}.

 \begin{lem}\label{bijsubvarsideals}
Let $k$ be a $\s$-field. Then the maps $X \mapsto \I(X)$ and $\a \mapsto \V(\a)$ define inclusion-reversing bijections between the set of all $\s$-subvarieties of $\mathbb{A}^n$ and the radical, mixed ideals of $k\{y_1,\ldots,y_n\}$.
\begin{bew}
From Proposition \ref{I=F_m} we know that $\I(\VV(\a)) = \a$ for all $\a \si k\{y_1,\ldots,y_n\}$ radial, mixed. Conversely, for a $\s$-variety $X = \VV(F) \subseteq \mathbb{A}^n$ we know  $\VV(\I(X)) = \VV(\I(\VV(F))) \subseteq \VV(F) = X$,
 since $F \subseteq \I(X)$. On the other hand it is clear from the definitions of $\VV$ and $ \I$, that $X \subseteq \VV(\I(X))$, so that $X = \VV(\I(X))$. This proves the bijectivity of both mappings. That both mappings are inclusion-reversing follows directly from the definitions.
\end{bew}
\end{lem}

Note that since $\s$-variety (as defined in this thesis) is a $\s$-subvariety of $\mathbb{A}^n$ for an $n \in \NE$, it is no restriction to consider $\mathbb{A}^n$ instead of an arbitrary $\s$-variety, as we can see in the following corollary:
\begin{cor}
  Let $X$ be a $\s$-variety over the $\s$-field $k$. Then there is a bijection between the radical, mixed $\s$-ideals of $k\{X\}$ and the $\s$-subvarieties of $X$ via
 $$X \supseteq Y \mapsto \{f \in k\{X\} \mid f(b) = 0 \fa b \in Y(B), \fa B \in \sintk \} =: \I_{k\{X\}}(Y)$$
\begin{bew}
If we identify the radical, mixed ideals of $k\{X\}$ with the radical, mixed ideals of $k\{y\}$ which contain $\I(X)$ (see Proposition \ref{bijideals}), then this is just the restriction of the mapping described in Lemma \ref{bijsubvarsideals}.
\end{bew}
\end{cor}

A further very interesting bijection can also help us better understand equivalence classes of solutions: 
\begin{prop}\label{bijsols}
Let $X = \VV(F)$ be a $\s$-variety over the $s$-field $k$. The equivalence classes of solutions of $F$ are in bijection with the $\s$-spectrum of the coordinate ring $\sSpec(k\{x\})$
\begin{bew}
Let $B \in \sintk$, $b \in B^n$ be a solution of $F \subseteq k\{y_1,\ldots,y_n\}$, i.e. $f(b) = 0 \fa f \in F$. Consider the mapping $$\varphi: k\{y_1,\ldots,y_n\} \rightarrow B, y \mapsto b\text{ (``plugging in'')}.$$
Then $F \subseteq $ ker$( \varphi) \si R$.
Since (forgetting the difference structure for a moment), $B$ is an integral domain, the ideal ker$(\varphi)$ has to be prime. This means that $\{F\}_m = \I(X) \subseteq $ker$(\varphi)$. 
In particular, this means that the mapping $\varphi$ factors over $\I(X)$, and it induces a morphism of $\s$-rings $\tilde \varphi: k\{X\} \rightarrow B$. By the same argument as above, the kernel of this induced
morphism, $\p_b := $ker$(\tilde \varphi) \si k\{X\}$ is a prime $\s$-ideal of $k\{X\}$. The kernel of the mapping constructed this way is always the same for equivalent solutions. To see this, let $b' \in B^n$ such that $k\{b\} \cong k\{b'\}$ via $\iota: b \mapsto b'$.
then it holds for the mapping $\varphi': k\{y_1, \ldots, y_n\} \rightarrow B', y \mapsto b$ that $\varphi' = \iota \circ \varphi$ (which is well-defined since Im$(\varphi)\subseteq k\{b\}$). In particular, since $\iota$ is an isomorphism, ker$(\varphi) = $ker$(\varphi')$. \\
\indent We define the mapping $\Psi$ from the equivalence classes of solutions of $F$ to $\sSpec(k\{X\})$ via $b \mapsto \p_b$. On the other hand, for $\p \in \sSpec(k\{X\})$ which we identify with $F \subseteq \tilde \p \in \sSpec(k\{y_1,\ldots,y_n\})$ (see Proposition \ref{bijideals}), consider the integral $\s$-ring $B(\p):= k\{y_1,\ldots,y_n\}/ \tilde \p$.
Since $\tilde \p$ is a prime $\s$-ideal, $B(\p)$ is an integral $\s$-ring. Set $b(\p) := \bar y \in B(\p)$, as the image of $y$ in $B(\p)$. Then, because $F \subseteq \p$ we know that $b(\p)$ is a solution of $F$. 
We define $\Psi^{-1}(\p)$ as the equivalence class of $b(\p)$. Then $\Psi$ and $\Psi^{-1}$ are inverses of each other, and hence, are both bijections.
\end{bew}
\end{prop}

From Proposition \ref{bijsols} we see that it is a good idea to concentrate on $\sSpec(k\{X\})$ for a $\s$-variety $X$ over a $\s$-field $k$.
 From here on, we will speak of the ``topology on/of X'' to refer to the topology on $\sSpec(k\{X\})$, as in Definition \ref{deftop}. 
We will also use the convention $x \in X$ to mean $x \in \sSpec(k\{X\})$, or $T \subseteq X$ closed to speak of a closed subset of $\sSpec(k\{X\})$, and so forth.

\subsection{Morphisms of Difference Varieties}

So far we have only studied difference varieties themselves, but not really a way to relate them with each other; we have yet to properly define the category of difference varieties over a fixed $\s$-field $k$: 
we still have to define what the morphisms in this category shall be.

\begin{defn}\label{spolynomialmaps}
Let $k$ be a $\s$-field, $X \subseteq \mathbb{A}^n,Y \subseteq \mathbb{A}^m$ $\s$-varieties over $k$. Then, a morphism of functors $f: X \rightarrow Y$ is called a \emph{morphism of $\s$-varieties over $k$} or \emph{$\s$-polynomial map} if 
there exist $\s$-polynomials $f_1,\ldots,f_m \in k\{y_1,\ldots,y_n\}$ such that $f(b) = (f_1(b),\ldots,f_m(b))$ for all $b \in X(B)$ for all $B \in \sintk$. \index{morphism of $\s$-varieties} \index{$\s$-polynomial map}
\index{morphism of $\s$-varieties} \index{$\s$-polynomial map}
\end{defn}

\begin{ex}
For two $\s$-varieties $X \subseteq Y = \mathbb{A}^n_A$, over the $\s$-field $k$, the inclusion mapping $\iota: X \hookrightarrow Y$ is a morphism of $\s$-varieties over $k$, since we can choose $f_1 = y_1, f_2 = y_2, \ldots, f_n = y_n$.
Similarly, for $m \geq n$ and $X \subseteq \mathbb{A}^m_A, Y \subseteq \mathbb{A}^n_A$ the ``projection onto $\mathbb{A}^n$'' is also a morphism of $\s$-varieties over $k$ (with the same choice of $f_i$ as the example above).
\end{ex}

\begin{rem}\label{dualmor}
Let $f: X \rightarrow Y$ be a morphism of $\s$-varieties over the $\s$-field $k$, $X \subseteq \mathbb{A}^n, Y \subseteq \mathbb{A}^m$. Then by definition there exist $f_1, \ldots, f_m \in k\{y_1,\ldots,y_n\}$ such 
that $f(b) = (f_1(b),\ldots,f_m(b))$ for all $b \in B, ~ B \in \sintk$. Modulo $\I(X)$, these $f_i$ are unique:
 If there is $f_1', \ldots, f_m' \in k\{y_1,\ldots,y_n\}$ such that $f_i(b) = f'_i(b) \fa b \in B, ~ B \in \sintk,$ and for all $i \in \underline{m}$,
then it follows that $(f_i - f_i')(b) = 0 \fa b \in B, ~ B \in \sintk$, which implies $f_i - f_i' \in \I(X)$ by definition, for all $i \in \underline{m}$. \\
\indent Now, consider the mapping \[ \phi: A\{z_1,\ldots,z_m \} \rightarrow A\{X\}, ~ z_i \mapsto f_i + \I(X) =: \overline{f_i} \]
This mapping factors over $\I(Y)$, since for $h \in \I(Y) \subseteq A\{z_1,\ldots,z_m\}$, $b \in X(B), ~ B \in \sintk$, we have that 
\[ (\phi(h))(b) = h(\overline f_1(b), \ldots, \overline f_m(b)) = h(f(b)) \]
But since $\varphi$ is a morphism of $\s$-varieties over $k$, it follows that $f(b) \in Y(B)$, which implies that $h(f(b)) = 0$, by choice of $h$, hence $h \in $ ker$(\phi)$.
Altogether, this yields a mapping 
\[ \f^* : k\{Y\} \rightarrow k\{X\}, ~ z_i + \I(Y) \mapsto y_i + \I(X) \]
This mapping is a morphism of integral $\s$-rings over $k$, and is called the \emph{dual mapping} or \emph{dual morphism} to $f$ \index{dual morphism}. It holds that
\[ f^*(h)(b) = h(f(b)) \fa h \in A\{Y\}, b \in X(B), ~ B \in \sintk. \]
From the definition it follows that for morphisms $X \xrightarrow{f} Y \xrightarrow{g} Z$ of $\s$-varieties over $A$, it holds that $ (f \circ g)^* = g^* \circ f^*$. 
We thus get a contravariant functor $-^*$ from the category of difference varieties over $k$ to $\sringk$.
\end{rem}

\begin{prop}\label{dualisequiv}
Let $k$ be a $\s$-field. Then $-^*$ as defined in Remark \ref{dualmor} is an anti-equivalence between the category of $\s$-varieties over $k$ and the subcategory of $\sringk$ which arises by restricting the object class to reduced, well-mixed, finitely $\s$-generated $\s$-overrings of $k$. 
In particular, a morphism $f: X \rightarrow Y$ of $\s$-varieties over $k$ is an isomorphism if and only $f^*: k\{Y\} \rightarrow k\{X\}$ is an isomorphism.
\begin{bew}
Since for a $\s$-variety $X$ over $k$, $\I(X)$ is radical and mixed, $k\{X\}$ is always a reduced and well-mixed $\s$-overring of $k$, 
and finitely $\s$-generated since $\s$-varieties are defined only for equations with finitely many difference variables. From this it follows that the functor $-^*$ from Remark \ref{dualmor} is also well defined on the category above.
It suffices to show that it is surjective on the skeleton of the categories and bijective on morphisms. 
Let $B$ be a finitely $\s$-generated, well-mixed and reduced $\s$-overring of $k$. We can then write $B \cong k\{y_1,\ldots,y_n\}/\a$, for an $\a \si k\{y_1,\ldots,y_n\}$ radical and mixed. The $\s$-variety $X = \VV(\a) \subseteq \mathbb{A}^n$
is then a preimage of the isomorphism class of $B$, since $\I(X) = \I(\VV(\a)) = \a$, and $\a = \{ \a \}_m$ because of Proposition \ref{I=F_m}. Thus, $B \cong k\{X\}$. \\
\indent Now, for the morphisms: First, let $X,Y$ be $\s$-varieties over $k$ and $f,g \in \Hom(X,Y)$ with $f^* = g^*$. Then we know that for every $h \in k\{X\}$, and every $b \in B, ~ B \in \sintk$ it holds that:
\[ h(f(b)) = f^*(h(b)) = g^*(h(b)) = h(g(b)). \]
In particular, $f(b) = g(b) \fa b \in B, ~ B \in \sintk$, which implies that $f = g$, and $-^*$ is injective. 
On the other hand, consider $\varphi: k\{Y\} \rightarrow k\{X\}$ a morphism of $\s$-overrings of $k$. There exist $n,m \in \NE$ such that $X \subseteq \mathbb{A}^n, Y \subseteq \mathbb{A}^m$,
 which means that $k\{X\} = k\{z_1,\ldots,z_n\}/\I(X), k\{Y\} = k\{y_1,\ldots,y_m\}/\I(Y)$. We will construct a preimage of $\varphi$: Choose $f_1,\ldots,f_m \in k\{z_1,\ldots,z_n\}$ such that $\varphi(y_i + \I(Y)) = f_i + \I(X) \fa i \in \underline{m}$.
Then we define a morphism $f: X \rightarrow Y$ of $\s$-varieties over $k$ as follows: $f(b) := (f_1(b),\ldots,f_m(b)) \fa b \in B, ~ B \in \sintk$. This is well-defined: Let $h \in \I(Y)$. Then, by definition, $h(y_1 + \I(Y),\ldots,y_n + I(Y)) = 0 + \I(Y)$.
This implies that $h(f_1 + \I(X),\ldots,f_m + \I(X)) = 0 + \I(X)$, since $\varphi$ is a morphism of $\s$-overrings of $k$. But this in turn implies that $h(f(b)) = 0 \fa b \in X(B), ~ B \in \sintk$, which means that $f$ maps indeed into $Y$ and $f^* = \varphi$ by construction.
\end{bew}
\end{prop}

This gives us a pretty good idea about the types of $\s$-varieties that can exist and the importance of the coordinate ring in difference algebra as well. 
Having defined a category for $\s$-varieties, we can now see how this new language helps us better understand the topological aspects of them.

\begin{lem}\label{inducedcont}
Let $R,S,T$ be $\s$-rings, and $\varphi: R \rightarrow S, \psi: S \rightarrow T$ morphisms of $\s$-rings. Then the mapping induced by $\varphi$ via $\tilde \varphi: \sSpec(S) \rightarrow \sSpec(R), \p \mapsto \varphi^{-1}(\p)$ is continuous. 
In fact, it holds that $\widetilde{ \psi \circ \varphi} = \tilde \varphi \circ \tilde \psi$, and in particular, $R \mapsto \sSpec(R)$ with $\tilde -$ is a contravariant functor from the category of $\s$-rings to Top, the category of topological spaces.
\begin{bew}
Let $A = \V(F) \subseteq \sSpec(R)$ be closed. We have to show that $\tilde \varphi^{-1}(A) \subseteq \sSpec(S)$ is closed.
But 
\begin{align*} \tilde \varphi^{-1}(A) = \tilde \varphi^{-1}(\V(F)) = \{ \p \in \sSpec(S) \mid F \subseteq \varphi^{-1}(\p) \} \\ = \{\p \in \sSpec(S) \mid \varphi(F) \subseteq \p \} = \V(\varphi(F)). \end{align*}
That $\widetilde{ \psi \circ \varphi} = \tilde \varphi \circ \tilde \psi$ is immediately clear from definition.
\end{bew}
\end{lem}

We see thus how radical, mixed $\s$-ideals and the definition of $\s$-varieties as functors from $\sintk$, for an integral $\s$-ring $A$, as well as the topology on $\sSpec(A\{X\})$ all fit together well. 
These are all in analogous relations to the case for perfect $\s$-ideals, where $\s$-varieties are defined from the category of $\s$-overfields of a $\s$-field $k$, and a topology called the Cohn topology is defined on $\Spec^\s(k\{X\})$ of $\s$-prime ideals (see Ch. 1 \& 2 of \cite{wibmer}).
The choice for the category $\sintk$ here is better motivated by the following:

\begin{defn}
Let $k$ be a $\s$-field. 
\begin{enumerate}[(a)]
\item We denote by $\s\text{\catname{-VarField}}_k$ the category which has functors of the form $B \mapsto \VV_B(F)$, where $B$ is a finitely $\s$-generated $\s$-field extension of $k$ as objects,
 and as morphisms $\s$-polynomial maps defined in a fashion analogous to Definition \ref{spolynomialmaps}. We define $\I_{\text{Field}}(X)$ for $X \in \s\text{\catname{-VarField}}_k$ and $\VV_{\text{Field}}(F)}$ analogous to Definitions \ref{defnVV} and \ref{defnI}.
\item Similarly, we denote by $\s\text{\catname{-VarDomain}}_k$ the category which has functors of the form $B \mapsto \VV_B(F)$, where $B$ is a finitely $\s$-generated $\s$-domain extension of $k$ as objects,
 and as morphisms $\s$-polynomial maps defined in a fashion analogous to Definition \ref{spolynomialmaps}. Again we define $\I_{\text{Domain}}(X)$ for $X \in \s\text{\catname{-VarDomain}}_k$ and $\VV_{\text{Domain}}(F)}$ analogous to Definitions \ref{defnVV} and \ref{defnI}
\item Finally,  we denote by $\s\text{\catname{-VarRing}}_k$ the category which has functors of the form $B \mapsto \VV_B(F)$, where $B \supseteq k$ is a perfectly $\s$-reduced, finitely $\s$-generated ring over $k$ as objects,
 and as morphisms $\s$-polynomial maps defined in a fashion analogous to Definition \ref{spolynomialmaps}. We also define $\I_{\text{Ring}}(X)$ for $X \in \s\text{\catname{-VarRing}}_k$ and $\VV_{\text{Ring}}(F)}$ analogous to Definitions \ref{defnVV} and \ref{defnI}
\end{enumerate}
In all three cases $F \subseteq k\{y\}$ denotes a set of $\s$-polynomials on finitely many difference variables $(y)$.
\end{defn}

\begin{prop}
Let $k$ be a $\s$-field. The three categories $\s\text{\catname{-VarField}}_k$, $\s\text{\catname{-VarDomain}}_k$ and $\s\text{\catname{-VarRing}}_k$ are equivalent.

\begin{bew}
Similar to Proposition \ref{dualisequiv}, the category $\s\text{\catname{-VarField}}_k$ is anti-equivalent to the category of perfectly $\s$-reduced $\s$-overrings of $k$ which are finitely $\s$-generated over $k$ (see \cite{wibmer}, p. 30).
It suffices to show that the other two categories are also anti-equivalent to it. From the proof of Proposition \ref{dualisequiv} we can see that it is enough to show that $\I_{\text{Domain}}(\VV_{\text{Domain}(\a)) = \{\a\}$, and $\I_{\text{Ring}}(\VV_{\text{Ring}(\a)) = \{\a\}$,
 where $\a \si k\{y\}$ is a $\s$-ideal and $\{ \a \}$ its perfect closure. 

Let first $X  = \VV_{\text{Ring}}(F) \in \s\text{\catname{-VarRing}}_k$ be a $\s$-variety in this sense of perfectly reduced $\s$-fields. 
We first show that \begin{align*} \I_{\text{Ring}}(X) =  \{ f \in k\{y\} \mid f(b) = 0 \fa b \in \VV_B(F), \\ B \supseteq k\text{ perfectly }\s\text{-reduced and finitely }\s\text{-generated over }k \} \end{align*}
 is a perfect $\s$-ideal. Similar to Proposition \ref{I=F_m}, we know that $\I_{\text{Ring}}(X)$ is a difference ideal. Let $f \in k\{y\}$ with $\s^{i_1}(f) \cdots \s^{i_r}(f) \in \I(X)$. This means that for all $b \in V_B(F)$,
 $B$ perfectly $\s$-reduced and finitely $\s$-generated over $k$: $\s^{i_1}(f)(b) \cdots \s^{i_r}(f)(b) = 0$. Since $B$ is perfectly $\s$-reduced, this means that $f(b) = 0$ for all such $b$,
 which in turn, by definition, means that $f \in \I(X)$. Since every $\s$-domain is perfectly $\s$-reduced, the argument works the same for $X \in \s\text{\catname{-VarDomain}}_k$ with $\I_{\text{Domain}}$ instead of $\I_{\text{Ring}}$.

For the other inclusion we shall consider first $X \in \s\text{\catname{-VarDomain}}_k$.
For $F \subseteq k\{y\}$, it holds that $\{F\} \subseteq \I_{\text{Domain}}(\VV_{\text{Domain}}(F))$. To show this, let $f \in \I_{\text{Domain}}(\VV_{\text{Domain}}(F))$.
It holds that $\{F\}$ is the intersection of all $\s$-prime ideals of $k\{y\}$ which contain $F$ (see for example Proposition 1.2.22 of \cite{wibmer}), so it is enough to show that $f \in \p$ for each $\s$-prime $\p \si k\{y\}$ with $F \subseteq \p$.
We define the $\s$-domain $B:= k\{y\}/\p =: k\{a\}$, with $a := y + \p \in k\{y\}/\p$. Since $F \subseteq \p$, it holds that $a \in \VV_B(F)$, which, by definition of $\I_{\text{Domain}}(\VV_{\text{Domain}}(F))$ means that $f(a) = 0$. Hence, $f \in \p$, for all $\s$ prime $\p$
with $F \subseteq \p$, which in turn means that $f \in \{F\}$. Since every $\s$-domain $B$ is perfectly $\s$-reduced, this works for the category $\s\text{\catname{-VarRing}}_k$ as well, with $\I_{\text{Ring}}, \VV_{\text{Ring}}$ instead of $\I_{\text{Domain}}, \VV_{\text{Domain}}$.
\end{bew}

\end{prop}
%% \begin{rem}
%% Let $f: X \rightarrow Y$ be a morphism of $\s$-varieties over the integral $\s$-ring $A$. Then the morphism $f^*: A\{y\} \rightarrow A\{x\}$ of $-s$-overrings of $A$ induces a continuous function
%% \[ \tilde{(f^*)}: \sSpec(A\{X\}) \rightarrow \sSpec(A\{Y\}), M \mapsto (f^*)^{-1}(M) \]
%% On the other hand FIXME: finish!
%% as in Lemma \ref{inducedcont}
%% \end{rem}

%% \begin{ex}
%% 2.4, here:more points? + 2.2.5

%% \end{ex}

%% section 2.3 not necesarry!

\clearpage 
\begin{thebibliography}{9}
\bibitem{wibmer} Wibmer, Michael \emph{Algebraic Difference Equations (Lecture Notes)}, Available online: \url{http://www.algebra.rwth-aachen.de/de/Mitarbeiter/Wibmer/Algebraic\%20difference\%20equations.pdf}
\bibitem{lang} Serge Lang, \emph{Algebra}, Revised Third Edition, Springer, 2005
\bibitem{eisenbud} Eisenbud, David \emph{Commutative Algebra with a View Toward Algebraic Geometry}, Springer, 1995
\bibitem{hartshorne} Hartshorne, Robin \emph{Algebric Geometry}, Springer, 1977
\bibitem{cohn} Cohn,  Richard \emph{Difference Algebra}, Interscience Publishers, 1965
\bibitem{levin} Levin, Alexander \emph{Difference Algebra}, Springer, 2008
\end{thebibliography}

\clearpage
\printindex
\end{document}
