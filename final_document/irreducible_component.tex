\subsection{A Geometric Application of Difference Kernels}

There is an application of difference kernels that is of a geometric nature. We will simply quote a result for the case of reflexive prime kernels here,
and do a partial generalization for the case that arises for some non-necessarily-reflexive prime $\s$-ideals. We obtain the geometrical result stated in the introduction.

\begin{theorem}\label{di=d(i+1)+e}
Let $k$ be a $\s$-field and let $\p \si k\{y\} = k\{y_1,\ldots,y_n\}$ be a prime $\s$-ideal of $k\{y\}$. For $i \in \N$ set $$d_i := \dim(k\{y\}[i]/\p[i]).$$
Then there exist integers $d, e \in \N$, such that $d_i = d(i+1) + e$ for $i \gg 0$. %%Moreover, $d = \s\operatorname{-trdeg}(k\{y\}/\p^*)$.
\begin{bew}
See Theorem 5.1 of \cite{wibmer}.
\end{bew}
\end{theorem}

\begin{defn}
Let $k$ be a $\s$-field and $\p \si k\{y_1,\ldots,y_n\}$ be a prime $\s$-ideal. Further, let $d, e \in \N$ be as in Theorem \ref{di=d(i+1)+e}. We call $d$ the \emph{$\s$-dimension} of $\p$, 
or the \emph{$\s$-dimension} of the irreducible $\s$-m-variety $X:= \VV(\p)$ and denote it by $\s$-$\dim(\p)$ and $\s$-$\dim(X)$, respectively. The other quantity, $e$, we call the \emph{$\s$-degree} of $\p$ or $X$ 
and us the symbol $\s$-$\operatorname{deg}$ for it. Finally, we can combine the information of both in a so-called \emph{dimension polynomial} $\omega_\p(i) := d(i+1) + e$, which then gives the dimension of $\p[i]$ for $i$ large enough.
\index{$\s$-deg} \index{$\s$-dim} \index{dimension polynomial}
\end{defn}

Recall from the introductory Section, Theorem \ref{irredcomp}:
\begin{reptheorem}{irredcomp}
Let $k$ be a $\s$-field and $f \in k\{y_1,\ldots,y_n\}, f \notin k$ an irreducible $\s$-polynomial, such that $\operatorname{Eord}(f) = \operatorname{Ord}(f)$. Then the $\s$-variety $\VV(f) \subset \mathbb{A}_k^n$ has an irreducible component $X$, such that $\s$-$\dim(X) = n-1$ and $\s$-$\operatorname{deg}(X) = \operatorname{Ord}(f)$.
\end{reptheorem}

While this statement is a very interesting result, it falls short quickly, as soon as the difference polynomial $f$ does not satisfy  $\operatorname{Eord}(f) = \operatorname{Ord}(f)$. This can be seen already in a very simple example.

\begin{ex}
Consider the $\s$-polynomial ring $\Q\{y_1\}$. The $\s$-polynomial $f := \s(y_1) - 1$ is obviously irreducible. The $\s$-variety $X:= \VV(f)$ has only one prime component, namely $[y_1]$, since $[y_1] = \{ \s(y_1) \}$ is $\s$-prime.
The dimension polynomial of $X$ is $\omega_X(i) = 0$, since $\Q\{y_1\}[i]/([y_1 - 1][i]) \cong \Q$ for all $i$. However, the order of $f$ is 1, which means that Theorem \ref{irredcomp} does not work for $f$. 
\end{ex}

\begin{theorem}\label{corfinal}
Let $k$ be a $\s$-field and $f \in k\{y_1,\ldots,y_n\}, f \notin k$ an irreducible $\s$-polynomial. 
Then the $\s$-m-variety $\VV(f) \subset \mathbb{A}_k^n$ has an irreducible closed subset $X$ such that $\s$-$\dim(X) = n-1$ and $\s$-$\operatorname{deg}(X) = \operatorname{Ord}(f)$.
\begin{bew}
Consider the $\s$-polynomial ring $k\{\s^d(y)\} =: k\{z\}$, where $d$ is maximal, such that $f \in k\{\s^d(y)\}$ (i.e., $d = \operatorname{Ord}(f) - \operatorname{Eord}(f)$). We let $f'\in k\{z\}$ be the $\s$-polynomial corresponding to $f$. 
Since $f$ is irreducible, $f'$ has to be irreducible as well. Additionally, by definition of $d$, it has to hold that $\operatorname{Eord}_z(f') = \operatorname{Ord}_z(f')$, where the order is considered with respect to $z$,
as indicated by the subscript. 

By Theorem \ref{irredcomp} we know that the $\s$-variety $ \VV(f')$ has an irreducible component $X' = \VV(\p)$ of $\s$-dimension $n-1$ and $\s$-degree $\operatorname{Ord}_z(f')$. In other words, there exists a $\s$-prime difference ideal $\p \si k\{z\}$ minimal over $\{f'\} \si k\{z\}$ with
$\s$-$\dim(\p) = n-1$ and $\s$-$\operatorname{deg}(\p) = \operatorname{Ord}_z(f')$. 

Now, we assert that the ideal $(\p)$ generated by $\p$ in $k\{y\}$ is a prime difference ideal. 
To prove this, let $f = \sum_{i=1}^r f_i p_i \in (\p)$, with $p_i \in \p; f_i \in k\{y\}$ for all $i$. Then, since $\p$ is a difference ideal, it has to be that $\s(p_i) \in \p$ for all $i$.
This, in turn, implies that $\s(f) =  \sum_{i=1}^r \s(f_i) \s(p_i) \in (\p)$. Thus, $(\p)$ is a difference ideal in $k\{y\}$. 

Now we can show the primality of $(\p)$. As rings, $$k\{y\} \cong k[y,\ldots,\s^{d-1}(y)] \otimes_k k\{z\}.$$
From Lemma \ref{lemtensor} it then follows that 
\begin{equation}\label{isomoduloideal} (k[y,\ldots,\s^{d-1}(y)] \otimes_k k\{z\}) / (\p) \cong k\{z\} / \p \otimes_k k[y,\ldots,\s^{d-1}(y)]. \end{equation}
Since $\p$ is prime, $k\{z\}/\p$ is an integral domain. This implies that $(k\{z\}/\p) \otimes_k k[y,\ldots,\s^{d-1}(y)]$ is an integral domain.
Equation (\ref{isomoduloideal}) then implies that $(\p) \si k\{y\}$ is prime as well. 

We only have to compare the dimension polynomials of $\p$ (over $k\{z\}$) and $(\p)$ over $k\{y\}$.
For this, we first consider the isomorphism
\begin{align*} \varphi: k\{y\} \xrightarrow{\sim} k[y,\ldots,\s^{d-1}(y)] \otimes_k k\{z\}, \\ (y,\ldots,\s^{d-1}(y)) \mapsto (y,\ldots,\s^{d-1}(y)); \s^d(y) \mapsto z. \end{align*}
For any $f \in k\{\s^{d}(y)\}$ we have the property that $\operatorname{Ord}_y(f) = \operatorname{Ord}_z(\varphi(f)) + d$ (where $\operatorname{Ord}_z$ is only defined on the subset $\varphi(k\{\s^d(y)\}) = k\{z\}$ of the ring $k\{z\}~\otimes_k~k[y,\ldots,\s^{d-1}(y)]).$
In particular, this means that $\varphi$ commutes with the operation of restricting to the $i$-th power of $\s$, in the following sense:
For a subset $F \subseteq k\{y\}$ and $i > d$ we have
\begin{align*} \varphi(F[i]) = \varphi(k\{y\}[i] \cap F) = \varphi(k\{y\}[i]) \cap \varphi(F) \\
 = (k[y,\ldots,\s^{d-1}(y)] \otimes_k k\{z\}[i-d]) \cap \varphi(F) .\end{align*}
If we apply this to $\p$, we get that for $i\geq 0$, $\varphi((\p)[i+d])~=~k[y,\ldots,\s^{d-1}(y)\otimes_k\p[i]$, and thus 
$$ k\{y\}[i+d]/(\p)[i+d] \cong \underbrace{k[y,\ldots,\s^{d-1}(y)]}_{ \text{dim} = d \cdot n} \otimes_k k\{z\}[i]/\p[i].$$
This implies that 
$$\operatorname{dim}(k\{y\}[i+d]/(\p)[i+d]) = \operatorname{dim}(k\{z\}[i]/\p[i]) + nd.$$
By definition of $\s$-$\operatorname{deg}$ and $\s$-$\operatorname{dim}$, we can conclude that 
\begin{align*}
(i+d+1) \s\text{-}\operatorname{dim}( (\p) ) = \omega_{(\p)}(i+d) = \omega_\p(i) + dn \\
= (i+1) \underbrace{\s\text{-}\operatorname{dim}(\p)}_{ = n - 1} + \underbrace{\s\text{-}\operatorname{deg}(\p)}_{\operatorname{Ord}(f')} + dn
\end{align*}
It follows that 
$$\s\text{-}\operatorname{dim}((\p))= \s\text{-}\operatorname{dim}(\p) = n-1, $$
as well as
$$\s\text{-}\operatorname{deg}((\p))= \s\text{-}\operatorname{deg}(\p) + d = \operatorname{Ord}(f') + d = \operatorname{Ord}(f).$$
Since $f \in (\p)$ and $(\p)$ is a prime difference ideal, the inclusion $\{f\}_m \subseteq (\p)$ is obvious, which in terms of the $\s$-m-varieties means that $\VV(\p) \subset \VV(f)$. 

%% We only have to show the minimality.
%% For this, assume there exists a prime difference ideal $\p' \si k\{y\}$ with $$\{f\}_m \subseteq \p' \subseteq (\p).$$
%% Then the ideal $k\{z\} \cap \p' \si k\{z\}$ is a prime, difference ideal and $f' \in k\{z\}.$
%% Since by assumption $\p' \subseteq (\p)$, we know that $$\p' \cap k\{z\} \subseteq (\p) \cap k\{z\} = \p.$$
%% Why is $\{f'\} \subseteq \p' \cap k\{z\}$???
%% The minimality of $ uao $
\end{bew}
\end{theorem}

\begin{ex}
We can return to the example of the $\s$-polynomial $f = \s(y_1) - 1$ in the ring $\Q\{y_1\}$. The $\s$-m-variety $X:= \VV(f)$ has only one prime component as well, namely $[\s(y_1)]$, since $[\s(y_1)] = \{ \s(y_1) \}_m$ is prime.
However, the dimension polynomial of $X$ is $\omega_X(i) = 1$, since \\ $\Q\{y_1\}[i]/([\s(y_1) - 1][i]) \cong \Q[y_1]$ for all $i$, in accordance to Theorem \ref{corfinal}.
\end{ex}


This theorem shows an application of the theory developed for mixed difference ideals, where in this generalization we do not need any restriction on the order of the difference polynomial.
It is not a complete generalization however, as it remains unclear if the irreducible closed subset given by the theorem is maximal, in other words, an irreducible component of $\VV(f)$.
%% The following simple example is not covered by the assertion of Theorem \ref{irredcomp}, but is a simple application of Theorem \ref{corfinal}.

%% \begin{ex}
%% Consider the irreducible $\s$-polynomial $$(\s^2(y_1 y_2 y_3) + 1) \in \Q\{y_1,y_2,y_3\}.$$
%% \end{ex}

%% \begin{lem}
%% Let $k$ be a $\s$-field and $f \in k\{y_1,\ldots,y_n\}, f \notin k$ an irreducible $\s$-polynomial.  
%% Then there exists a prime difference ideal $\q \si k\{y_1,\ldots,y_n\}$, minimal containing $f$, and a $d \in \N$, such that 
%% $$\dim(k\{y_1,\ldots,y_n\}[i]/\q[i]) = \left\{ \begin{array}{lr} i, i < \operatorname{Ord}(f) \\ d(i-\operatorname{Ord}(f)) +\ operatorname{Ord}(f),
%%  i \geq \operatorname{Ord}(f) \end{array} \right.$$
%% \end{lem}

