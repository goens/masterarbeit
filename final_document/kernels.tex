%%blah blah de entrada...
%% \begin{theorem}

%% Let $k$ be a $\s$-field and $a$ 
%% \end{theorem}
In this section we will see a further approach to investigating difference ideals. We will take a look at the properties a difference ideal has by looking at its intersection with the variables up to a finite power of sigma.

\begin{defn}
Let $k$ be a difference field and $d \in \N$. Then we define $k\{y\}[d]:= k[y,\s(y),\ldots,\s^d(y)]$ and we set $k\{y\}[-1] := k$. Let $\a \si k\{y\}$ be a difference ideal in the full $\s$-polynomial ring $k\{y\}$. 
We set $\a[d] := \a \cap k\{y\}[d]$.
\end{defn}


\begin{defn}
Let $\a \unlhd k\{y\}[d], d \geq 1$ be an ideal of $k\{y\}[d]$. Then $\a$ is called a \emph{difference kernel of length $d$}, if $\s(\a[d-1]) \subseteq \p$. The difference kernel is called \emph{prime}, if additionally $\a$ is a prime ideal of $k\{y\}[d]$.
Finally, $\a$ is called a \emph{reflexive difference kernel of length $d$} if $\s^{-1}(\a) = \a[d-1]$. \index{difference kernel} \index{prime difference kernel} \index{reflexive difference kernel}
\end{defn}\index{difference kernels}

It is worth noting that this notation differs from that of the standard literature (in particular \cite{cohn} and \cite{levin}). In the standard literature, the quotient ring obtained by factoring out 
what we here defined as a prime, reflexive kernel is called a kernel, and the rest of the concepts are not treated. We chose to change the notation here to be able to study other $\s$-ideals with this methodology.

\begin{rem}
It is easy to see that a reflexive kernel is always a kernel, but the converse is not necesarilly true: $\a$ being a kernel of length $d$ only guarantees the inclusion $\a[d-1] \subseteq \s^{-1}(\a)$.
\end{rem}

\begin{ex}
Let $\p \si k\{y\}$ be a prime $\s$-ideal, $d \geq 1$. Then $\p[d] \unlhd k\{y\}[d]$ is a prime kernel: since $\p$ is a $\s$-ideal we have $\s(\p[d-1]) \subseteq \p$, 
and since $\p$ is prime we know that $\p[d]$ has to be prime as well. If $\p$ is also reflexive (i.e. a $\s$-prime ideal), then $\p[d]$ is a reflexive, prime kernel. 
\end{ex}

Inspired by the former example we define the following:
\begin{defn}
Let $\a \unlhd k\{y\}[d]$ be a kernel of length $d$, and $\a' \si k\{y\}$ be a $\s$-ideal. Then we call $\a'$ a realization of $\a$, if $\a \subseteq \a'$, 
and we call the realization regular if it also holds that $\a'[d] = \a$. Similarly, if $\a$ is a reflexive/prime kernel, then we define a realization to be a reflexive/prime realization if the $\s$-ideal $\a'$ is reflexive/prime.
\end{defn}\index{(regular) realization}

The former example and the acompanying definition are actually much more general than it would seem to be at first. 
It is in fact the case that prime,reflexive kernels are always of the form $\p[d]$ for a $\s$-prime ideal $\p$.
For prime kernels which are not reflexive in general it is not that simple, as we will also see later. 

\begin{rem}\label{sigmawelldeffker}
Let $\p \subseteq k\{y\}$ be a difference kernel of length $d$. Then, $\s$ induces a well-defined mapping 
\begin{align*}
\s: k[y,\ldots,\s^{d-1}(y)]/\p[d-1] \rightarrow k[y,\ldots,\s^{d}(y)]/\p
\end{align*}
If $\p$ is a reflexive kernel, then this mapping is injective. 
We set $a := \bar y = y + \p \in k\{y\}[d]/\p$. If $\p$ is a prime, reflexive kernel, then we can extend $\s$ to the quotient fields:
\[ \s: k(a,\ldots,s^{d-1}(a)) \cong \text{Quot}(k[y,\ldots,\s^{d-1}(y)]/\p[d-1]) \rightarrow k(a,\ldots,\s^d(a)) = k(\p) \]
\end{rem}

Even in the case of prime difference kernels we can work with the properties of field extensions, though we cannot properly extend $\s$ to the fields.
 In particular, we get a nice way of defining some sort of ``difference degree'' of prime kernels:
\begin{defn}
Let $\p \subseteq k\{y\}$ be a prime difference kernel of length $d$, and let $a:= y + \p \in k(p)$; we define the difference dimension of $\p$ as follows:
\begin{align*} \sdim(\p) := \text{trdeg}(k(\p)/k(\p[d-1]) = \text{trdeg}((k\{y\}[d]/\p)/(k\{y\}[d-1]/\p[d-1])) \\  = \text{trdeg}(k(a,\ldots,\s^{d}(a))/k(a,\ldots,\s^{d-1}(a))) \end{align*}
\end{defn}\index{$\s$-dimension of a $\s$-kernel}

If we want to show that prime,reflexive difference kernels are the intersection of $\s$-prime ideals with $k\{y\}[d]$, and similar cases for other types of kernels,
it is reasonable to consider some sort of extension, or \emph{prolongation} of a kernel, which would be the intesrection with $k\{y\}[d+1]$.  \index{prolongation (of a difference kernel)}
This motivates the following definition: 

\begin{defn}
Let $\a \subseteq k\{y\}$ be a difference kernel of length $d$, and $\a' \supset \a$ be a further difference kernel, of length $d+1$.
Then we call $\a'$ a \emph{prolongation} of $\a$, iff $\a'[d] = \a$. Similarly, for a prime/reflexive kernel we say the prolongation is prime/reflexive if, $\a'$ is also prime/reflexive.
For a prime prolongation, if it holds further that $\sdim(\a) = \sdim(a')$, then we call the prolongation \emph{generic}.
\end{defn}\index{generic prolongation}

\begin{defn}
Let $\p \subseteq k\{y\}$ be a prime difference kernel of length $d$, and let $\p'$ be a realization of $\p$. We call $\p'$ a \emph{principal realization} of $\p$, if $\p'[i+1]$ is a generic prolongation of $\p'[i]$ for all $i \geq d$,
and we say the realization is \emph{reflexive} if the prolongations are reflexive. \index{principal realization} \index{reflexive realization}
\end{defn}

As mentioned above, the case for reflexive, prime kernels is well understood. It can be summarized by the following Theorem, which can be found as Corollary 5.2.8 of \cite{wibmer}:
\begin{theorem}
Let $\q \subseteq k\{y\}$ be a prime, reflexive kernel of length $d$. Then there exists a reflexive, generic prolongation of $\q$. 
\end{theorem}

The case is unfortunately not as simple in the case of prime kernels that are not necessarily reflexive, as shown by the following example.

\begin{ex}
Consider the difference polynomials $f_1 := \s(y_2) + 1, f_2:= \s(y_1)y_2 + y_1y_2 + \s(y_1) + y_1 + y_2 \in k[y_1,y_2,\s(y_1),\s(y_2)] =: R$.
A calculation with \cite{M2} quickly identifies that the ideal $(f_1,f_2) \unlhd R$ is prime, and in fact, $f_1,f_2$ is a Gr\"{o}bner Basis of $(f_1,f_2)$ with respect to the
term ordering $y_1 < y_2 < \s(y_1) < \s(y_2)$. This means in particular, that $(f_1,f_2)[0] = \{0\}$, and thus $(f_1,f_2)$ is a prime kernel of length $1$ of $k\{y_1,y_2\}$. However,
\[ f_1 \cdot (\s^2(y_1) + \s(y_1) + 1 ) - \s(f_2) = 1 \]
Which means that any $\s$-ideal of $k\{y_1,y_2\}$ containing $f_1, f_2$ is already the whole ring, and is not prime, by definition.
\end{ex}

%We see thus, that we need a stronger concept for prime kernels, if we are to classify those prime kernels which are intersections of prime $\s$-ideals with $k\{y\}[d]$ for a $d \in \N$. 

%% \begin{defn}
%% Let $\a \unlhd k\{y\}[d]$ be a difference kernel of length $d$. We define 
%% \[\a^* := ([\a]^*)[d] = \{ f \in k\{y\} \mid \text{ there exists an } n \in \N: \s^n(f) \in [\a] \} \cap k\{y\}[d] \]
%% Then $\a^*$ is an ideal in $k\{y\}[d]$. If $\a$ is a prime kernel, we say that $\a$ is \emph{regular} if $\a^* \unlhd k\{y\}[d]$ is also prime. \index{regular weak kernel}
%% \end{defn}

%% \begin{rem}\label{regular->kernel}
%% From the definitions it is easily clear that for a prime kernel $\p \unlhd k\{y\}[d]$, $\p^*$ is a prime, reflexive kernel if and only if $\p$ is regular. 
%% \end{rem}

%% The definition of $\a^*$ for a kernel $\a$ of length $d$, while clear from the theoretical standpoint, makes use of the whole difference polynomial ring $k\{y\}$. 
%% We would want a way of locally obtaining $\a^*$, i.e., only in $k\{y\}[d]$. Luckily, there is a nice algorithmical way of doing this using Gröbner bases.
%% To do this, we fix a lexicographical ordering on the variables $y = y_1, \ldots, y_n$, and from this we define a lexicographical ordering on $k\{y\}$ as follows:
%% \[ \s^{m_1}(y_{i_1}) < \s^{m_2}(y_{i_2})\text{ if and only if }m_1 > m_2\text{ or }m_1 = m_2\text{ and }y_{i_1} < y_{i_2} \]
%%  By a lexicograhpical order we mean that if we order the variables as $x = (x_1,\ldots,x_{dn})$, then for two monomials $x^A, x^B$ with multi-index vectors $A,B$ we define
%% \[ x^A > x^B \text{ if and only if the first non-zero entry of } A-B \text{ is positive} \]
%% We will use this term ordering for the remainder of this section.
%% %% We will also use the concept of Gröbner bases used in \cite{cox}, which is slightly weaker than usual: A Gröbner basis for the ideal $I \unlhd R$ is a finite set $G$
%% %% for which it holds that $(LT(G)) = (LT(I))$. For example, a (not auto-reduced) set like $\{ x^2, -x^2 \}$ would, by this definition be a Gröbner basis for the ideal $(x^2)$.
%% \begin{rem}\label{remorder}
%% Let $k$ be an inversive $\s$-field. Then it holds for an $f \in k\{y\}$ that $f$ is a power of $\s$, i.e. $f = \s^m(f')$ for an $f' \in k\{y\}$,
%% if and only if this is the case for $LT(f)$, in which case it also holds that $LT(f) = s^k(LT(f')) = LT(\s^k(f'))$.
%% \begin{bew}
%% If $f =  \s^m(f')$, then every monomial of $f$ is as well an $m$-th power of $\s$, in particular, $LT(f)$ as well.
%% On the other hand let $LT(f) = \s^m(g)$ for a monomial $g \in k\{y\}$, and assume that $f$ cannot be written as $\s^m(f')$ for an $f' \in k\{y\}$. 
%% Then there must be a monomial $a$ of $f$ which cannot be written as $\s^k(a')$ for a monomial $a' \in k\{y\}$. In particular, since $k$ is inversive, $a'$ has a variable $\s^j(y_i)$ with $j < k$,
%% which is not the case for $LT(f)$ by assumption. This means, however, that $a' > LT(f)$, a contradiction. 
%% The last equalities all hold by the definition of the term ordering.
%% \end{bew}
%% \end{rem}

%% \begin{lem}\label{lemgroebner}
%% Let $k$ be a $\s$-field, and $k^*$ its inversive closure. Further let $\a \subset k\{y\}[d]$ be a kernel of length $d$, and $f_1, \ldots, f_r$ be a Gröbner basis for $\a$. 
%% Then the ideal $\a^*$ is given by 
%% \[ \a^* = \underbrace{(\s^{-i}(f_j) \mid 0 \leq i \leq d, 1 \leq j \leq r)}_{\unlhd k^*\{y\}[d]} \cap k\{y\}[d] \]
%% where we by this notation ignore the $\s^{-i}(f_j)$ which do not exist. This is even a Gröbner basis for $\a^*$. %% in the sense of \cite{cox}.
%% In particual, if $k$ is inversive, it holds that
%% \[ \a^* = (\s^{-i}(f_j) \mid 0 \leq i \leq d, 1 \leq j \leq r) \unlhd k\{y\}[d] \]
%% \begin{bew}
%% We consider first the special case where $k$ is inversive. One inclusion is obvious, as the elements $\s^{-i}(f_j)$, if they exist, have to be in $\a^*$. For the other inclusion let $f \in \a^*$.
%% It is enough to show that there exists a $\s^{-i}(f_j)$ such that $LT(\s^{-i}(f_j))$ divides $LT(f)$ (see for example \cite{cox}, p.75). 
%% By definition of $\a^*$ there exists an $n \in \N$ such that $\s^n(f) \in [\a]$. This means that $\s^n(LT(f)) = LT(\s^n(f)) \in LT([\a][d+n])$. 
%% Since $f_j, 0 \leq j \leq r$ is a Gröbner basis of $\a$, it is clear that $(LT([\a][d+n]))$ is generated by $LT(\s^i(f_j)), 0 \leq i \leq n, 0 \leq j \leq r$ as a monomial ideal in $k\{y\}[d+n]$.
%% Note: I'm not sure this is true, why couldn't it cancel out farther up? It really looks to be non-trivial to calculate $\a[d]$ from $\s$-generators of $\a$...
%% Hence, there exists a $\s^i(f_j)$ and a monomial $m \in k\{y\}[d+n]$ such that $\s^n(LT(f)) = LT(\s^i(f_j)) h$. Since these are monomials and $k$ is inversive it follows that both $LT(\s^i(f_j))$
%% and $h$ have to be images of the $\n$-th power of $\s$, i.e. $\s^{i-n}(LT(f_j))$ and $\s^{-n}(h)$ exist and it holds that $LT(f) = \s^{i-n}(LT(f_j)) \cdot \s^{-n}(h)$ since $\s$ is injective on $k\{y\}$.
%% Since $\s^{i-n}(LT(f_j))$ exists and Ord$(LT(f_j)) \leq d$, it holds that $n \leq d$.
%% Now, for the general case: we know that $\a^*_{k^*} := ((\a)_{k^*\{y\}[d]})^* \unlhd k^*\{y\}[d]$ is given as
%% \[ \a^*_{k^*} = (\s^{-i}(f_j) \mid 0 \leq i \leq d, 1 \leq j \leq r) \unlhd k^*\{y\}[d] \]
%% and since $\a \subseteq (\a)_{k^*\{y\}[d]}$, it is obvious that $\a^* \subseteq \a^*_{k^*}$.
%% We further know that $\a^* \subseteq k\{y\}[d]$, so that we get 
%% \[ \a^* \subseteq \underbrace{(\s^{-i}(f_j) \mid 0 \leq i \leq d, 1 \leq j \leq k) \cap k\{y\}[d]}_{=:\b} \]
%% For the other inclusion: For $f \in \b$ we know there exist $r_{i,j} \in k\{y\}[d]$ such,
%% that $f = \sum_{i,j} \s^{-i}(f_j)r_{i,j}$. Then, $\s^d(f) = \s^d(\sum_{i,j} \s^{-i}(f_j)r_{i,j}) = \sum_{i,j}\s^{d-i}(f_j)\s^d(r_{i,j}) \in [\a]$,
%% which means that $f \in \a^*$, by definition.
%% \end{bew}
%% \end{lem}

%% This is a very helpful description of $\a^*$, as it is contained in the polynomial ring $k\{y\}[d]$ which has finitely many variables.
%% As a result of this we can get a way of knowing when prolongations of regular prime kernels are regular, as we will soon see.

%% \begin{defn}
%% Let $k$ be a $\s$-field and  $\a \si k\{y\}$ be a $\s$-ideal. 
%% Further let $d_1, d_2 \in \Z$ with $-1 \leq d_1 < d_2$ We define $\a[d_1, d_2]:= \a[d_2] \backslash \a[d_1] = \{ r \in a[d_2] \mid r \notin a[d_1] \}$.
%% Note that this is not an ideal, as, for example, $0 \notin \a[d_1,d_2]$, but every element in $r \in a[d_1,d_2]$ has the property that $d_1 < $Ord$(r) \leq d_2$.
%% \end{defn}

%% \begin{lem}\label{extrags}
%% Let $\a \subset k\{y\}[d]$ be a difference kernel of length $d$, and let $\b \subseteq k\{y\}[d+1]$ be a prolongation of $\a$. 
%% Further let $f_1,\ldots,f_r$ be a Gröbner basis of $\a$. Then there exist $g_1,\ldots,g_s \in k\{y\}[d,d+1]$ such that each $g_j, 1 \leq j \leq s$ has only monomials in
%% $k\{y\}[d,d+1]$, and $f_1, \dots, f_r, g_1, \ldots, g_s$ is a Gröbner basis for $\b$. 
%% \begin{bew}
%% Because $k\{y}[d+1] = k\{y\}[d] \cup k\{y}[d,d+1]$, the union is disjoint, we can write any Gröbner basis of $\b$ as 
%% $\tilde f_1, \ldots \tilde f_{\tilde r}, g_1, \ldots,  g_{ s}$,
%% with $LT(\tilde f_1), \ldots, LT(\tilde f_{\tilde r}) \in k\{y\}[d]$, and $LT(g_1), \ldots, LT(g_{ s}) \in k\{y\}[d,d+1]$.
%% For each pair of monomials $a \in (LT(f_1, \ldots, f_r)), b \in k\{y\}[d,d+1]$ it holds that $a > b$,
%% Since $LT(g_j), 1 \leq j \leq s$ is a monomial, it has to be of order $d+1$, and since any $m$ monomial of lower order 
%% would satisfy that $m > LT(f)$, it has to be that every monomial of $f$ is of order $d+1$. 
%% On the other hand, as $\b[d] = \a$, it has to be that $LT((\tilde f_1, \ldots, \tilde f_{\tilde r})) = LT((f_1,\ldots,f_r)) = LT(\a)$.
%% So that we can replace the first half of the basis with the Gröbner basis of $\a$. NOT QUITE YET! What if the f_i have terms of order d+1??
%% \end{bew}
%% \end{lem}

%% \begin{lem}
%% Let $\p \subset k\{y\}[d]$ be a regular weak kernel of length $d$ with Gröbner basis $h_1,\ldots,h_t$, 
%% and let $f_1,\ldots,f_r$ be a Gröbner basis of the kernel $\p^*$. Further let $\q$ be a prolongation of $\p^*$  and $g_1,\ldots,g_s$ as in Rem. \ref{extrags},
%%  so that $f_1,\ldots,f_r,g_1,\ldots,g_s$ is a Gröbner basis of $\q$. Then $\q':= (h_1,\ldots,h_t,g_1,\ldots,g_s)$ is a prolongation of $\p$, and is a regular weak kernel. 
%% %%If $\q$ is a generic prolongation, so is $\q'$ as well.
%%  \begin{bew}
%% By Rem. \ref{extrags} each $g_j$ has only coefficients in $k\{y\}[d,d+1]$, so that any $k\{y\}[d+1]$-linear combination $\sum_{i=1}^r d_i f_i + \sum_{j=1}^s d_{r+j}g_j$,
%% such that $\sum_{j=1}^s d_{r+j}g_j \neq 0$ has to lie in $\q'[d,d+1]$. In particular, $\q'[d] = (f_1,\ldots,f_r) = \p$.
%% Since $\p \subseteq \p^*$, it is clear as well that $\s(\p) \subseteq \s(\p^*)$. This means that $\s(\p) \subseteq \q'$:
%% Let $f = \sum_{i=1}^td_i h_i \in \p$. Then $\s(g) = \s(\sum_{i=1}^td_i h_i) \in \q[d,d+1]$.
%% For those $h_i$ with $LT(h_i) \in k\{y\}[d-1]$, $\s(h_i) \in \p$ since $\p$ is a kernel, so it is enough to show that $\s(h_i) \in \q'$ for $LT(h_i) \in \p[d-1,d]$.
%% If $LT(h_i) \in \p[d-1,d]$, then every monomial of $\s(h_i)$ has to have order $d+1$. But by the choice of the $g_j$, in $\q$ we can write $\s(h_i)$ as a $k{y}[d+1]$-linear combination of 
%% the $g_j, 0 \leq j \leq s$, which means that $\s(h_i) \in \q'$, and thus $f \in \q'$. 
%% Further, by Lemma \ref{lemgroebner} we know that $(\q')^* = \q$, which means that the $\q'$ is also regular.
%% %%Now let $\q$ be a regular prolongation of $\p^*$. FINISHME!
%% \end{bew}
%% \end{lem}

FIXME: finish this! (one time expnad + counterexample + conjecture + eventually application, the one theorem)

\begin{lem}\label{primeoverp1}
Let R be an integral domain and $I \unlhd R[y]$ be an ideal of $R[y] = R[y_1,\ldots,y_n]$ which satisfies that $I \cap R = \{ 0 \}$.
Then there exists a prime ideal $P, I \subseteq P \subseteq R[y] $ with $P \cap R = \{0\}$.
\begin{proof}
We can assume without loss of generality that I is radical:
Namely, if $f \in \sqrt{I} \cap R$, then there exists an $m \in \N$ such that $f^m \in I \cap R = \{0\}$, and since $R$ is an integral domain this already means that $f = 0$.
We then note that for two sets $A,B \subseteq R[y]$ it holds that $\sqrt{A}\sqrt{B} \subseteq \sqrt{AB}$: Consider $f \in \sqrt{A}, g \in \sqrt{B}$. Then there exist $m, \tilde m \in \N$ such that $f^m \in (A), g^{\tilde m} \in (B)$;
 assume without loss of generality that $m > \tilde m$, then $(fg)^m \in (A)(B)$, which implies $fg \in \sqrt{(A)(B)} = \sqrt{AB}$.
Now, for the proof, consider the set of all radical ideals $J$ contaning $I$ which satisify $J \cap R = \{0\}$. This set is not empty and is inductively ordered by inclusion.
By Zorn's lemma this means that there is a maximal element $P$ of this set. This ideal $P$ is prime, then: assume there exist $f,g \notin P$ with $fg \in P$. 
Then the radical ideals $\sqrt{P \cup \{f\}}$, $\sqrt{P \cup \{f\}}$ strictly include $P$, and by the maximality of $P$ it means there exist $t_1, t_2 \in R\backslash\{0\}$ such that
$t_1 \in \sqrt{P \cup \{f\}}$, $t_2 \in \sqrt{P \cup \{g\}}$. But in particular, because $R$ is free of zero divisors, this implies that
 \[0 \neq t_1t_2 \in \sqrt{P \cup \{f\}}\sqrt{P \cup \{g\}} \subseteq \sqrt{ \underbrace{(P \cup \{f\})(P \cup \{g\})}_{=P\text{, since }fg \in P}} = P\]
A contradiction.
\end{proof}
\end{lem}


\begin{prop}\label{genericprol}
Let $\p \subseteq k\{y\}$ be a (regular weak) difference kernel of length $d$. Then there exists a prolongation of $\p$. If $\p$ is a kernel, then there exists a prologation that is generic. 
\begin{bew}
Consider the canonical epimorphism of rings $k[y,\ldots,\s^{d}(y)] \rightarrow k[y,\ldots,\s^{d}(y)]/\p$ and let $a = y + \p$ be the image of $y$ under it. 
Then the we have a subring $R_1: = k[a,\ldots,\s^{d-1}(a)] \subseteq k[a,\ldots,\s^{d}(a)] = k[y,\ldots,\s^{d}(y)]/\p =: R$. Now, consider the univariate polynomial ring over $R_1$ on the free variable $\s^d(y)$:
\[ R_1[\s^d(y)] = k[a,\ldots,\s^{d-1}(a)][s^d(y)] = k[a,\ldots,\s^{d-1}(a),s^d(y)] \]
We have a natural morphism of rings \[ R_1[s^d(y)] \rightarrow R = k[a,\ldots,\s^{d}(a)], \s^d(y) \mapsto \s^d(a) \]
Let $\p_1$ be the kernel of this morphism. Since $R$ is an integer domain (as $\p$ is prime), so is $\p_1$ also prime. 
Now we consider the univariate polynomial ring $R[\s^{d+1}(y)] \supset R = k[a,\ldots, \s^d(a)]$. Here we get a natural definition of $\s: R_1[\s^d(y)] \rightarrow R[\s^{d+1}(y)]$ by mapping $\s( \s^d(y))  := \s^{d+1}(y)$.
By definition of $\p_1$ we have that $\s(\p_1) \cap R = \{0\}$. 

We first consider the case where $\p$ is a kernel. In this case, $\s$ from Remark \ref{sigmawelldeffker} is injective and we can go over to the quotient fields:
We let $\tilde \p_1$ be the prime ideal which is the kernel of the morphism of rings
\[ \text{Quot}(R_1)[s^d(y)] \rightarrow \text{Quot}(R) = k(a,\ldots,\s^{d}(a)), \s^d(y) \mapsto \s^d(a) \]
And let $\tilde \p_2$ be a minimal prime ideal in 
\[k(a,\ldots,\s^d(a))[\s^{d+1}(y)] = \text{Quot}(k[a,\ldots,\s^d(a)])[\s^{d+1}(y)] \] containing $\s(\tilde \p_1)$.
In particular, $\s$ is injective and thus an isomorphism to the prime ideal $\s(\tilde \p_1) \subseteq \s(k)(\s(a),\ldots,\s^d(a))[\s^{d+1}(y)]$.
It holds that the mapping
\[ \s: k(a,\ldots,\s^{d-1}(a))[\s^d(y)]/\tilde \p_1 \rightarrow k(a,\ldots, \s^d(a))[\s^{d+1}(y)]/\tilde \p_2 \]
is well-defined and injective as well. By abuse of notation (and because of the minimality of $\tilde \p_2$ again) 
we will also call $\s^{d+1}(a)$ the image of $\s^{d+1}(y)$ in $k(\tilde \p_2) = \text{Quot}(k(a,\ldots, \s^d(a))[\s^{d+1}(y)]/\tilde \p_2)$.
Then the kernel $\q$ of \[ k[y,\ldots,\s^{d+1}(y)] \rightarrow k(\tilde p_2), \s^{i}(y) \mapsto \s^{i}(a) \] is a prolongation of $\p$, as above, and we have:
\begin{align*}
\sdim(\p) = \trdeg( k(a,\ldots,\s^d(a)) / k(a,\ldots,\s^{d-1}(a))) = \text{dim}(k(a,\ldots,\s^{d-1}(a))[\s^d(y)]/\tilde \p_1) \\ = \text{dim}(\s(k)(\s(a),\ldots,\s^d(a))[\s^{d+1}(y)]/\s(\tilde \p_1)) 
= \text{dim}(k(a,\ldots,\s^{d}(a))[\s^{d+1}(y)]/\tilde \p_2) \\ = \trdeg(k(a,\ldots,\s^{d+1}(a))/k(a,\ldots,\s^d(a))) = \sdim(\q)
\end{align*}

Now back to the general case: If $\p$ is a regular weak kernel, by the proof above, there existis a prolongation of $\p^*$, since by Remark \ref{regular->kernel}, $\p^*$ is a kernel. 
In particular, since $\p \subseteq \p^*$ we know that \[ (\s(\tilde \p_1)) \subseteq (\s(\tilde \p_1)) \subset \tilde p_2 \],
and since $\{0\} = \tilde p_2 \cap k(a,\ldots,\s^d(a)) \supseteq k[a,\ldots,\s^d(a)] = R$ it yields that $(\p_1) \cap R = \{0\}$.
By Lemma \ref{primeoverp1} there exists a minimal prime ideal $\p_2 \supset (\s(\p_1))$ of $R[\s^{d+1}(y)]$ containing $\s(p_1)$ with $\p_2 \cap R = \{0\}$. 
We thus get a well-defined maping
\[ \s: k[a,\ldots,\s^{d-1}(a)][\s^d(y)]/\p_1 \rightarrow k[a,\ldots, \s^d(a)][\s^{d+1}(y)]/\p_2 \]
We define $R_2:= k[a,\ldots,\s^d(a)][\s^{d+1}(y)]/\p_2 =: k[a,\ldots,\s^d(a),\s^{d+1}(a)]$, which is an integer domain since $\p_2$ was prime. Since $\p_2 \cap R = \{0\}$ we can use this notation unambiguosly:
this guarantees namely that for $a, \ldots, \s^d(a)$ we have the same residue classes modulo $\p_2$ as we had modulo $\p$.
The kernel $\p'$ of the natural epimorphism $k[y,\ldots,\s^{d+1}(y)] \rightarrow R_2$ is thus a prime ideal.
Further we have $\p \subseteq \p'$ by construction (as $\p = 0 \subset R_2$). In fact, it holds that $\p'[d] = \p$ since: 
\begin{align*}
\p'[d] = \{ f \in k[y,\ldots,\s^d(y)] \mid f(a) = 0 \} = \ker( k\{y\}[d] \rightarrow k[a,\ldots,\s^{d}(a)]) = \p
\end{align*}
where the first equality uses the fact that $\p_2 \cap R = \{0\}$, as noted by the use of the notation explained above, and last equality holds by definition of $a \in R$. This means, that $\p'$ is a prolongation of $\p$. 
We only have to show that $\p'$ is regular. FINISH-ME!
\end{bew}
\end{prop}


\begin{prop}
Let $\p \subseteq k\{y\}$ be a (weak) kernel of length $d$. Then there exists a realization of $\p$. If $\p$ is a kernel, then this realization is principal.
In particular, weak kernels are exactly of the form $\p[d]$ for a prime $\s$-ideal $\p \si k\{y\}$, and similarly kernels for $\s$-prime ideals.
\begin{bew}
By Lemma \ref{genericprol} there exists a chain of prolongations $\p_{d+1} \supset \p$, $\p_{d+2} \supset \p_{d+1}, \ldots$, which are generic if $\p$ is a kernel.
Consider \[ \p':= \bigcup_{i \geq d} \p_i \]
This is a prime $\s$-ideal, since for $f \in \p'$ there exists an $i \in \N$ such that $f \in \p_i$. Then $\s(f) \in \s(p_{i+1}) \subset \p'$.
Since all $p_i$ are prime, any product $fg \in \p'$ must already be in a $\p_i$ for $i \in \N$ and thus $f \in \p_i$ or $g \in \p_i$. Further,
 if $\p$ is a kernel, then $\s^{-1}(\p_i) = \p_{i-1} \subset \p'$, so $\p'$ is reflexive. By construction is $\p'[d] = \p$ and if $\p$ is a kernel then the
 prolongations are all generic and thus $\p'$ is principal. Since for a prime $\s$-ideal $\p$ we have that $\p[d]$ is a weak kernel, and a kernel if $\p$ is also reflexive, 
the final assertion follows.
\end{bew}
\end{prop}


\begin{ex}

\end{ex}




%% \begin{lem}
%% Let $\p \si k\{y\}$ be a prime $\s$-ideal and let $\p' := \p^* \supseteq \p$ be its reflexive closure (which is $\s$-prime). Then there exists an $n \in \N$ such that 
%% $\p[d_1,d_2] = \p'[d_1,d_2] \fa n \leq d_1 < d_2$.
%% \begin{bew}
%% We know that there exists an $n \in \N$ such that $\s^{-n}(\p) = \p^* = \p'$ is $\s$-prime. Let $d > n$. Then 
%% we have $\s^{-n}(\p[d]) = \s^{-n}(\p \cap k\{y\}[d]) = \s^{-n}(\p)\cap\s^{-n}(k\{y\}[d]) = \p'[d-n]$. 
%% Since $\p'[d-n]$ is a kernel of length $d-n$, we know that there exist unique generic prolongations of $\p'[n-d]$
%% \end{bew}
%% \end{lem}



        %% @Misc{M2,
        %%   author = {Grayson, Daniel R. and Stillman, Michael E.},
        %%   title = {Macaulay2, a software system for research 
        %%            in algebraic geometry},
        %%   howpublished = {Available at 
        %%       \href{http://www.math.uiuc.edu/Macaulay2/}%
        %%            {http://www.math.uiuc.edu/Macaulay2/}}
        %% }

\end{document}

